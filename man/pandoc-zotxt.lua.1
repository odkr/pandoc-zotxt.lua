.\" Automatically generated by Pandoc 2.10.1
.\"
.TH "pandoc-zotxt.lua" "1" "October 23, 2020" "" ""
.hy
.SH NAME
.PP
pandoc-zotxt.lua - Looks up sources in Zotero
.SH SYNOPSIS
.PP
\f[B]pandoc\f[R] \f[B]--lua-filter\f[R] \f[I]pandoc-zotxt.lua\f[R]
\f[B]--citeproc\f[R]
.PP
\f[B]pandoc\f[R] \f[B]--lua-filter\f[R] \f[I]pandoc-zotxt.lua\f[R]
\f[B]--filter\f[R] \f[I]pandoc-citeproc\f[R]
.SH DESCRIPTION
.PP
\f[B]pandoc-zotxt.lua\f[R] looks up sources of citations in Zotero and
adds them either to a document\[aq]s \f[C]references\f[R] metadata field
or to its bibliography, where \f[B]pandoc\f[R] can pick them up.
.PP
You cite your sources using so-called \[dq]easy citekeys\[dq] (provided
by zotxt) or \[dq]Better BibTeX Citation Keys\[dq] (provided by Better
BibTeX for Zotero).
Then, when running \f[B]pandoc\f[R], you tell it to filter your document
through \f[B]pandoc-zotxt.lua\f[R] by passing \f[B]--lua-filter\f[R]
\f[I]pandoc-zotxt.lua\f[R].
That\[aq]s all there is to it.
You also have to tell \f[B]pandoc\f[R] to process citations, of course.
(How you do this depends on your version of Pandoc.)
.SH BIBLIOGRAPHY FILES
.PP
You can also use \f[B]pandoc-zotxt.lua\f[R] to manage a bibliography
file.
This speeds up subsequent runs of \f[B]pandoc-zotxt.lua\f[R] for the
same document, because \f[B]pandoc-zotxt.lua\f[R] will only fetch
sources from Zotero that aren\[aq]t yet in that file.
Simply set the \f[C]zotero-bibliography\f[R] metadata field to a
filename.
\f[B]pandoc-zotxt.lua\f[R] will then add sources to that file, rather
than to the \f[C]references\f[R] metadata field.
It will also add that file to the document\[aq]s \f[C]bibliography\f[R]
metadata field, so that \f[B]pandoc\f[R] picks up those sources.
The biblography is stored as a JSON file, so the filename must end with
\[dq].json\[dq].
You can safely set \f[C]zotero-bibliography\f[R] \f[I]and\f[R]
\f[C]bibliography\f[R] at the same time.
.PP
\f[B]pandoc-zotxt.lua\f[R] interprets relative filenames as relative to
the directory of the first input file that you pass to \f[B]pandoc\f[R]
or, if you don\[aq]t pass any input file, as relative to the current
working directory.
.PP
Note, \f[B]pandoc-zotxt.lua\f[R] only ever \f[I]adds\f[R] sources to
bibliography files.
It doesn\[aq]t update or delete them.
If you want to update the sources in your bibliography file, delete it.
\f[B]pandoc-zotxt.lua\f[R] will then regenerate it from scratch.
.SH KNOWN ISSUES
.PP
Zotero, from v5.0.71 onwards, doesn\[aq]t allow browsers to access its
interface.
It defines \[dq]browser\[dq] as any user agent that sets the \[dq]User
Agent\[dq] HTTP header to a string that starts with \[dq]Mozilla/\[dq].
.PP
However, Zotero v5.0.71 and v5.0.72 fail to handle HTTP requests from
user agents that don\[aq]t set the \[dq]User Agent\[dq] HTTP header.
And \f[B]pandoc\f[R] doesn\[aq]t.
As a consequence, \f[B]pandoc-zotxt.lua\f[R] cannot retrieve data from
these versions of Zotero, that is, unless you tell \f[B]pandoc\f[R] to
set that header.
.PP
If you cannot upgrade to a more recent version of Zotero, you can make
\f[B]pandoc\f[R] set that header by passing, for instance,
\f[B]--request-header\f[R] \f[I]User-Agent:Pandoc/2\f[R].
If you must set the \[dq]User Agent\[dq] HTTP header to a string that
starts with \[dq]Mozilla/\[dq], you can still get \f[B]pandoc\f[R] to
connect to Zotero by setting the HTTP header
\[dq]Zotero-Allowed-Request\[dq].
You do so by passing \f[B]--request-header\f[R]
\f[I]Zotero-Allowed-Request:X\f[R].
.SH CAVEATS
.PP
\f[B]pandoc-zotxt.lua\f[R] is for the most part Unicode-agnostic.
.SH SEE ALSO
.IP \[bu] 2
zotxt (https://github.com/egh/zotxt)
.IP \[bu] 2
Better BibTeX (https://retorque.re/zotero-better-bibtex/)
.PP
pandoc(1), pandoc-citeproc(1)
.SH AUTHORS
Odin Kroeger.
