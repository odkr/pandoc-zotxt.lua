<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>pandoc-zotxt.lua</h1>


<h2>Contents</h2>
<ul>
<li><a href="#Metadata">Metadata </a></li>
<li><a href="#Types">Types </a></li>
<li><a href="#Meta_programming">Meta-programming </a></li>
<li><a href="#Tables">Tables </a></li>
<li><a href="#Strings">Strings </a></li>
<li><a href="#Basic_prototypes">Basic prototypes </a></li>
<li><a href="#Warnings">Warnings </a></li>
<li><a href="#File_I_O">File I/O </a></li>
<li><a href="#Networking">Networking </a></li>
<li><a href="#Markup_converters">Markup converters </a></li>
<li><a href="#CSL_items">CSL items </a></li>
<li><a href="#Citation_keys">Citation keys </a></li>
<li><a href="#Bibliography_files">Bibliography files </a></li>
<li><a href="#Document_parsing">Document parsing </a></li>
<li><a href="#Option_parsing">Option parsing </a></li>
<li><a href="#Zotero_connectors">Zotero connectors </a></li>
<li><a href="#Main">Main </a></li>
</ul>


<h2>Scripts</h2>
<ul class="nowrap">
  <li><strong>pandoc-zotxt.lua</strong></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="../topics/README.md.html">README</a></li>
</ul>

</div>

<div id="content">

<h1>Script <code>pandoc-zotxt.lua</code></h1>
<p><h2>SYNOPSIS</h2>

<p> <strong>pandoc</strong> <strong>-L</strong> <em>pandoc-zotxt.lua</em> <strong>-C</strong></p>

<h2> DESCRIPTION</h2>

<p> <strong>pandoc-zotxt.lua</strong> is a Lua filter for Pandoc that looks up citations in
 Zotero and adds their bibliographic data to the &ldquo;references&rdquo; metadata field
 or to a bibliography file, where Pandoc can pick it up.</p></p>
<p> You cite your sources using so-called &ldquo;Better BibTeX citation keys&rdquo;
 (provided by Better BibTeX for Zotero) or &ldquo;Easy Citekeys&rdquo; (provided by
 zotxt) and then tell <strong>pandoc</strong> to filter your document through
 <strong>pandoc-zotxt.lua</strong> before processing citations. That&rsquo;s all there is to it.</p>

<p> If the &ldquo;references&rdquo; metadata field or a bibliography file already contains
 bibliographic data for a citation, that citation will be ignored.</p>

<h2> CONNECTING TO ZOTERO</h2>

<h2> Desktop client</h2>

<p> By default, bibliographic data is fetched from the Zotero desktop client,
 which must be running when you invoke <strong>pandoc</strong>. This is the faster,
 easier, and less error-prone method to lookup citations in Zotero. However,
 you need to install the zotxt add-on for the Zotero desktop client to use
 it.</p>

<h2> Web API</h2>

<p> Bibliographic data can also be fetched from the Zotero Web API. If you want
 to access your Zotero library via the Web API, create a Zotero API key and
 set the metadata field &ldquo;zotero-api-key&rdquo; to that key.</p>

<p> If you want to fetch bibliographic data from <em>public</em> Zotero groups, list
 the IDs of those groups in the metadata field &ldquo;zotero-public-groups&rdquo;. The
 groups have to allow non-members to access their libraries; however, you do
 not need an API key to access them.</p>

<p> The Zotero Web API does <em>not</em> allow to search for citation keys other than
 Zotero item IDs. Therefore, BetterBibTeX citation keys and Easy Citekeys
 have to be translated into search terms: Better BibTeX citation keys are
 split up at the first of each series of digits and at uppercase letters
 (&ldquo;DoeTitle2020&rdquo; becomes &ldquo;Doe&rdquo;, &ldquo;Title&rdquo;, &ldquo;2020&rdquo;). Easy Citekeys are split up
 at the first colon and at the last digit (&ldquo;doe:2020title&rdquo; becomes &ldquo;doe&rdquo;,
 &ldquo;2020&rdquo;, &ldquo;title&rdquo;).</p>

<p> If a search yields more than one item, you need to add the citation key to
 the item&rsquo;s &ldquo;extra&rdquo; field in Zotero to disambiguate, using either the field
 name &ldquo;Citation key&rdquo; or &ldquo;Citekey&rdquo;; e.g., &ldquo;Citation key: DoeTitle2020&rdquo;. If
 you added the BetterBibTeX for Zotero add-on to the Zotero desktop client,
 you can do so by &lsquo;pinning&rsquo; the citation key. Alternatively, you can cite
 the source using its Zotero item ID.</p>

<h2> BIBLIOGRAPHY FILES</h2>

<p> Bibliographic data can be added to a bibliography file, rather than to the
 &ldquo;references&rdquo; metadata field. This speeds up subsequent processing of the
 same document, because that data need not be fetched again from Zotero.</p>

<p> To use such a bibliography file, set the &ldquo;zotero-bibliography&rdquo; metadata
 field to a filename. If the filename is relative, it is interpreted as
 relative to the directory of the first input file passed to <strong>pandoc</strong> or,
 if no input file was given, as relative to the current working directory.</p>

<p> The format of the file is determined by its filename ending:</p>

<table>
<thead>
<tr>
<th> <strong>Ending</strong> </th>
<th> <strong>Format</strong> </th>
</tr>
</thead>
<tbody>
<tr>
<td> <code>.json</code>    </td>
<td> CSL JSON   </td>
</tr>
<tr>
<td> <code>.yaml</code>    </td>
<td> CSL YAML   </td>
</tr>
</tbody>
</table>


<p> The bibliography file is added to the &ldquo;bibliography&rdquo; metadata field
 automatically. You can safely set &ldquo;zotero-bibliography&rdquo; and &ldquo;bibliography&rdquo;
 at the same time.</p>

<p> Records are only ever added to the bibliography file, never changed or
 deleted. If you need to change or delete a record, delete the bibliography
 file, so that it will be regenerated from scratch.</p>

<h2> CITATION KEY TYPES</h2>

<p> You can use citation keys of multitple types:</p>

<table>
<thead>
<tr>
<th> <strong>Name</strong>          </th>
<th> <strong>Type</strong>                   </th>
<th> <strong>Example</strong>   </th>
</tr>
</thead>
<tbody>
<tr>
<td> <code>betterbibtexkey</code> </td>
<td> Better BibTeX citation key </td>
<td> DoeTitle2020  </td>
</tr>
<tr>
<td> <code>easykey</code>         </td>
<td> Easy Citekey               </td>
<td> doe:2020title </td>
</tr>
<tr>
<td> <code>key</code>             </td>
<td> Zotero item ID             </td>
<td> A1BC23D4      </td>
</tr>
</tbody>
</table>


<p> However, Better BibTeX citation keys are sometimes, if rarely,
 misinterpreted as Easy Citekeys and still match an item, though <em>not</em> the
 one that they are the citation key of.</p>

<p> If this happens, disable Easy Citekeys by only listing BetterBibTeX
 citation keys and, if you use them, Zotero item IDs in the
 &ldquo;zotero-citekey-types&rdquo; metadata field:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
<span class="comment">---
</span>zotero-citekey-types: betterbibtexkey
...
Forces @DoeTitle to be treated as a BetterBibTeX citation key.
EOF
</pre>


<h2> SETTINGS</h2>

<p> You can configure how bibligraphic data is fetched by setting the following
 metadata fields:</p>

<ul>
<li><p><code>zotero-api-key</code>: A Zotero API key. Needed to access your personal
library via the Zotero Web API; not needed to access public groups.</p></li>
<li><p><code>zotero-bibliography</code>: A bibliography filename. Fetched bibliographic
data is added to this file. (See &ldquo;Bibligraphy Files&rdquo; above for details.)</p></li>
<li><p><code>zotero-citekey-types</code>: A list of citation key types. Citation keys are
treated as being of any of the listed types only. (See &ldquo;Citation Key Types&rdquo;
above for details.)</p></li>
<li><p><code>zotero-connectors</code>: One or more Zotero connectors:</p>

<table>
<thead>
<tr>
<th> <strong>Key</strong>   </th>
<th> <strong>Fetch data from</strong>   </th>
</tr>
</thead>
<tbody>
<tr>
<td> zotero    </td>
<td> Zotero desktop client </td>
</tr>
<tr>
<td> zoteroweb </td>
<td> Zotero Web API        </td>
</tr>
</tbody>
</table>


<p>Data is fetched via the listed connectors only.</p>

<p>By default, the Zotero desktop client is searched first. If you have set
a Zotero API key and the client could not be reached or some citations
not be found, the Zotero Web API is searched next.</p></li>
<li><p><code>zotero-groups</code>: A list of Zotero group IDs. Only the listed groups are
searched. By default, all groups that you are a member of are searched.</p></li>
<li><p><code>zotero-public-groups</code>: A list of Zotero group IDs. Listed groups are
searched in addition to the groups that you are a member of, if any. These
groups must be public. (See &ldquo;Zotero Web API&rdquo; above for details.)</p></li>
<li><p><code>zotero-user-id</code>: A Zotero user ID. Needed to fetch data via the Zotero
Web API, but looked up automatically if not given.</p></li>
</ul>


<p> If a metadata field takes a list of values, but you only want to give one,
 you can enter that value as a scalar.</p>

<h2> EXAMPLES</h2>

<p> Look up &ldquo;DoeTitle2020&rdquo; in Zotero:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
See @doe2020Title <span class="keyword">for</span> details.
EOF
</pre>


<p> Add bibliographic data to the file &ldquo;bibliography.json&rdquo;:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
<span class="comment">---
</span>zotero-bibliography: bibliography.json
...
See @DoeTitle2020 <span class="keyword">for</span> details.
EOF
</pre>


<p> Interpret &ldquo;doe:2020title&rdquo; as a Better BibTeX citation key:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
<span class="comment">---
</span>zotero-citekey-types: betterbibtexkey
...
See @doe:<span class="number">2020</span>title <span class="keyword">for</span> details.
EOF
</pre>


<p> Fetch data from the Zotero Web API, too:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
<span class="comment">---
</span>zotero-api-key: MO2GHxbkLnWgCqPtpoewgwIl
...
See @DoeTitle2020 <span class="keyword">for</span> details.
EOF
</pre>


<p> Fetch data from the Zotero Web API <em>only</em>:</p>

<pre>
pandoc -L pandoc-zotxt.lua -C &lt;&lt;EOF
<span class="comment">---
</span>zotero-api-key: MO2GHxbkLnWgCqPtpoewgwIl
zotero-connectors: zoteroweb
...
See @DoeTitle2020 <span class="keyword">for</span> details.
EOF
</pre>


<h2> KNOWN ISSUES</h2>

<p> Citation keys may, on rare occassions, be matched with the wrong Zotero
 item. This happens if a citation key picks out a different record depending
 on whether it is interpreted as a Better BibTeX citation key or as an easy
 citekey. See &ldquo;CITATION KEY TYPES&rdquo; above on how to address this.</p>

<p> <strong>pandoc-zotxt.lua</strong> creates a temporary file when it adds bibliographic
 data to a bibliography file. If Pandoc exits because it catches a signal
 (e.g., because you press <code>Ctrl</code>-<code>c</code>), then this file will <em>not</em> be deleted.
 This is a bug in Pandoc and in the process of being fixed. Moreover, if you
 are using Pandoc up to v2.7, another process may, mistakenly, use the same
 temporary file at the same time, though this is highly unlikely.</p>

<p> Zotero v5.0.71 and v5.0.72 fail to handle HTTP requests from user agents
 that do not set the &ldquo;User Agent&rdquo; HTTP header. And <strong>pandoc</strong> does not. As a
 consequence, <strong>pandoc-zotxt.lua</strong> cannot retrieve data from these versions
 of Zotero unless you tell <strong>pandoc</strong> to set that header.</p>

<p> Support for accessing group libraries via the Zotero Web API is limited.
 They are only searched if no item in your personal library matches. Also,
 the &ldquo;extra&rdquo; field of items in group libraries is ignored.</p>

<h2> SECURITY</h2>

<p> If you are using Pandoc up to v2.7 and place the auto-generated
 bibliography file in a directory that other users have write access to,
 then they can read and change the content of that file, regardless of
 whether they have permission to read or write the file itself.</p>

<h2> CAVEATS</h2>

<p> <strong>pandoc-zotxt.lua</strong> is Unicode-agnostic.</p>

<h2> SEE ALSO</h2>

<ul>
<li><a href="https://github.com/egh/zotxt">zotxt</a></li>
<li><a href="https://retorque.re/zotero-better-bibtex/">Better BibTeX</a></li>
</ul>


<p> pandoc(1)</p>
    <h3>Info:</h3>
    <ul>
        <li><strong>Copyright</strong>: 2018, 2019, 2020, 2021 Odin Kroeger</li>
        <li><strong>Release</strong>: 1.1.0b5</li>
        <li><strong>License</strong>: MIT</li>
        <li><strong>Author</strong>: Odin Kroeger</li>
    </ul>


<h2><a href="#Metadata">Metadata </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#NAME">NAME</a></td>
	<td class="summary">The name of this script.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#VERSION">VERSION</a></td>
	<td class="summary">The version of this script.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#SCRIPT_DIR">SCRIPT_DIR</a></td>
	<td class="summary">The directory the script is located in.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#SCRIPT_NAME">SCRIPT_NAME</a></td>
	<td class="summary">The filename of the script.</td>
	</tr>
</table>
<h2><a href="#Types">Types </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#type_match">type_match (val, decl)</a></td>
	<td class="summary">Check whether a value is of a type.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#typed_args">typed_args (...)</a></td>
	<td class="summary">Type-check function arguments when running in debugging mode.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#typed_keyword_args">typed_keyword_args (types)</a></td>
	<td class="summary">Type-check keyword arguments when running in debugging mode.</td>
	</tr>
</table>
<h2><a href="#Meta_programming">Meta-programming </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#vars_get">vars_get ([level=2])</a></td>
	<td class="summary">Get a copy of the variables that a function can access.</td>
	</tr>
</table>
<h2><a href="#Tables">Tables </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ignore_case">ignore_case</a></td>
	<td class="summary">A metatable to make tables ignore case.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ignore_case.__index">ignore_case.__index (tab, key)</a></td>
	<td class="summary">Look up an item.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#ignore_case.__newindex">ignore_case.__newindex (tab, key, val)</a></td>
	<td class="summary">Store a new item.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#copy">copy (val)</a></td>
	<td class="summary">Make a deep copy of a value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#keys">keys (tab)</a></td>
	<td class="summary">Get the keys and the number of items in a table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#order">order (values)</a></td>
	<td class="summary">Define a sorting function from a list of values.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#sorted">sorted (tab[, func])</a></td>
	<td class="summary">Iterate over the key-value pairs of a table in a given order.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#tabulate">tabulate (iter[, tab[, key]])</a></td>
	<td class="summary">Tabulate the values an iterator returns.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#walk">walk (val, func)</a></td>
	<td class="summary">Walk a graph and apply a function to every node.</td>
	</tr>
</table>
<h2><a href="#Strings">Strings </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#split">split (str, pattern[, max[, include]])</a></td>
	<td class="summary">Iterate over substrings of a string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#trim">trim (str)</a></td>
	<td class="summary">Remove leading and trailing whitespace.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#vars_sub">vars_sub (str, vars)</a></td>
	<td class="summary">Substitute variables in strings.</td>
	</tr>
</table>
<h2><a href="#Basic_prototypes">Basic prototypes </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Object">Object</a></td>
	<td class="summary">Base prototype.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Object.mt">Object.mt</a></td>
	<td class="summary">Metatable for prototypes.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Object.mt.__call">Object.mt.__call (proto[, tab])</a></td>
	<td class="summary">Delegate to a prototype.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Object.new">Object.new</a></td>
	<td class="summary">Initialise a new object.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Values">Values</a></td>
	<td class="summary">A simple list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Values.n">Values.n</a></td>
	<td class="summary">The number of items in the list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Values:add">Values:add (...)</a></td>
	<td class="summary">Add items to the list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#getterify">getterify (tab)</a></td>
	<td class="summary">Add getters to a table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#delegate_with_getters">delegate_with_getters (proto[, tab])</a></td>
	<td class="summary">Delegate to a prototype and add getters.</td>
	</tr>
</table>
<h2><a href="#Warnings">Warnings </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#xwarn">xwarn (...)</a></td>
	<td class="summary">Print a message to STDERR.</td>
	</tr>
</table>
<h2><a href="#File_I_O">File I/O </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#PATH_SEP">PATH_SEP</a></td>
	<td class="summary">The path segment separator used by the operating system.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#EOL">EOL</a></td>
	<td class="summary">The end of line sequence used on the given operating system.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#path_join">path_join (...)</a></td>
	<td class="summary">Join multiple path segments.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#path_normalise">path_normalise (path)</a></td>
	<td class="summary">Normalise a path.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#path_split">path_split (path)</a></td>
	<td class="summary">Split a path into a directory and a filename.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#path_is_abs">path_is_abs (path)</a></td>
	<td class="summary">Check whether a path is absolute.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#path_prettify">path_prettify (path)</a></td>
	<td class="summary">Prettify paths.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#wd">wd ()</a></td>
	<td class="summary">Get a directory to use as working directory.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#file_exists">file_exists (fname)</a></td>
	<td class="summary">Check whether a file exists.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#file_locate">file_locate (fname)</a></td>
	<td class="summary">Locate a file in Pandoc&rsquo;s resource path.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#file_read">file_read (fname)</a></td>
	<td class="summary">Read a file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#file_write">file_write (fname, ...)</a></td>
	<td class="summary">Write data to a file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#tmp_fname">tmp_fname ([dir[, templ='pdz-XXXXXX']])</a></td>
	<td class="summary">Generate a name for a temporary file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#with_tmp_file">with_tmp_file (func[, dir[, templ]])</a></td>
	<td class="summary">Run a function with a temporary file.</td>
	</tr>
</table>
<h2><a href="#Networking">Networking </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#http_get">http_get (url)</a></td>
	<td class="summary">Retrieve data from a URL via an HTTP GET request.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#url_query">url_query (url[, params])</a></td>
	<td class="summary">Query a URL via an HTTP GET request.</td>
	</tr>
</table>
<h2><a href="#Markup_converters">Markup converters </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#escape_markdown">escape_markdown (str)</a></td>
	<td class="summary">Escape Markdown syntax.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#markdownify">markdownify (elem)</a></td>
	<td class="summary">Convert a Pandoc element to Markdown text.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#yamlify">yamlify (val[, ind=4[, sort]])</a></td>
	<td class="summary">Generate a YAML representation of a value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#zotero_to_html">zotero_to_html (pseudo)</a></td>
	<td class="summary">Convert Zotero pseudo-HTML to proper HTML.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#zotero_to_markdown">zotero_to_markdown (pseudo)</a></td>
	<td class="summary">Convert Zotero pseudo-HTML to Markdown.</td>
	</tr>
</table>
<h2><a href="#CSL_items">CSL items </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#CSL_VARS_ORDER">CSL_VARS_ORDER</a></td>
	<td class="summary">Preferred order of CSL variables.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_item_extras">csl_item_extras (item)</a></td>
	<td class="summary">Iterate over every key-value pair in the &ldquo;note&rdquo; field of a CSL item.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_item_add_extras">csl_item_add_extras (item)</a></td>
	<td class="summary">Add CSL variables from the &ldquo;note&rdquo; field to the item proper.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_item_normalise_vars">csl_item_normalise_vars (item)</a></td>
	<td class="summary">Normalise variable names of a CSL item.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_item_to_meta">csl_item_to_meta (item)</a></td>
	<td class="summary">Convert a CSL item to a Pandoc metadata value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_items_filter_by_ckey">csl_items_filter_by_ckey (items, ckey)</a></td>
	<td class="summary">Filter CSL items by their citation key.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_items_ids">csl_items_ids (items)</a></td>
	<td class="summary">Pick the IDs of CSL items out of a list of CSL items.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_items_sort">csl_items_sort (a, b)</a></td>
	<td class="summary">Sort CSL items by their ID.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_varname_normalise">csl_varname_normalise (var)</a></td>
	<td class="summary">Normalise a CSL variable name.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_vars_sort">csl_vars_sort (a, b)</a></td>
	<td class="summary">Sort CSL variables.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#csl_json_to_items">csl_json_to_items (str)</a></td>
	<td class="summary">Parse a CSL JSON string.</td>
	</tr>
</table>
<h2><a href="#Citation_keys">Citation keys </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#citekey">citekey</a></td>
	<td class="summary">An interface for parsing citation keys.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#citekey.parsers">citekey.parsers</a></td>
	<td class="summary">A mapping of citation key types to parsers.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#citekey.parsers.betterbibtexkey">citekey.parsers.betterbibtexkey (ckey)</a></td>
	<td class="summary">Guess search terms from a BetterBibTeX citation key.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Citekey.parsers.easykey">Citekey.parsers.easykey (ckey)</a></td>
	<td class="summary">Guess search terms from an Easy Citekey.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#citekey:guess_terms">citekey:guess_terms (ckey, types)</a></td>
	<td class="summary">Guess search terms from a citation key.</td>
	</tr>
</table>
<h2><a href="#Bibliography_files">Bibliography files </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#biblio">biblio</a></td>
	<td class="summary">An interface for reading, writing, and updating bibliography files.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types">biblio.types</a></td>
	<td class="summary">A case-insensitive mapping of filename suffices to codecs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.bib">biblio.types.bib</a></td>
	<td class="summary">Decode BibLaTeX.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.bib.decode">biblio.types.bib.decode (str)</a></td>
	<td class="summary">Read the IDs from the contents of a BibLaTeX file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.bibtex">biblio.types.bibtex</a></td>
	<td class="summary">Decode BibTeX.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.bibtex.decode">biblio.types.bibtex.decode (str)</a></td>
	<td class="summary">Read the IDs from the contents of a BibTeX file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.json">biblio.types.json</a></td>
	<td class="summary">De-/Encode CSL items in JSON.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.json.decode">biblio.types.json.decode (str)</a></td>
	<td class="summary">Parse a CSL JSON string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.json.encode">biblio.types.json.encode (items)</a></td>
	<td class="summary">Serialise a list of CSL items to a JSON string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.yaml">biblio.types.yaml</a></td>
	<td class="summary">De-/Encode CSL items in YAML.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.yaml.decode">biblio.types.yaml.decode (str)</a></td>
	<td class="summary">Parse a CSL YAML string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.yaml.encode">biblio.types.yaml.encode (items)</a></td>
	<td class="summary">Serialise a list of CSL items to a YAML string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio.types.yml">biblio.types.yml</a></td>
	<td class="summary">Alternative suffix for YAML files.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio:read">biblio:read (fname)</a></td>
	<td class="summary">Read a bibliography file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio:write">biblio:write (fname[, items])</a></td>
	<td class="summary">Write bibliographic data to a bibliography file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#biblio:update">biblio:update (handle, fname, ckeys)</a></td>
	<td class="summary">Add new items from Zotero to a bibliography file.</td>
	</tr>
</table>
<h2><a href="#Document_parsing">Document parsing </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#elem_clone">elem_clone (elem)</a></td>
	<td class="summary">Make a shallow copy of a Pandoc AST element.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#elem_type">elem_type (elem)</a></td>
	<td class="summary">Get the type of a Pandoc AST element.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#elem_walk">elem_walk (elem, filter)</a></td>
	<td class="summary">Walk an AST and apply a filter to matching elements.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#meta_sources">meta_sources (meta)</a></td>
	<td class="summary">Collect bibliographic data.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#doc_ckeys">doc_ckeys (doc[, undef])</a></td>
	<td class="summary">Collect the citation keys used in a document.</td>
	</tr>
</table>
<h2><a href="#Option_parsing">Option parsing </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Option">Option</a></td>
	<td class="summary">An option definition</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Options">Options</a></td>
	<td class="summary">An option parser.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Options:new">Options:new ()</a></td>
	<td class="summary">Create a new option parser.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Options:add">Options:add (...)</a></td>
	<td class="summary">Add an option definition to the parser.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Options:parse">Options:parse (meta)</a></td>
	<td class="summary">Get configuration options from a metadata block.</td>
	</tr>
</table>
<h2><a href="#Zotero_connectors">Zotero connectors </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#connectors">connectors</a></td>
	<td class="summary">A case-insensitive namespace for connector prototypes.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.Zotero">connectors.Zotero</a></td>
	<td class="summary">Interface to <a href="https://github.com/egh/zotxt">zotxt</a>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.Zotero.options">connectors.Zotero.options</a></td>
	<td class="summary">Zotero options.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.Zotero.citekey_types">connectors.Zotero.citekey_types</a></td>
	<td class="summary">Types of citation keys to expect.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.Zotero:fetch">connectors.Zotero:fetch (ckey)</a></td>
	<td class="summary">Fetch a CSL item via zotxt.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb">connectors.ZoteroWeb</a></td>
	<td class="summary">Interface to <a href="https://www.zotero.org/support/dev/web_api">Zotero&rsquo;s Web API</a></td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.citekey_types">connectors.ZoteroWeb.citekey_types</a></td>
	<td class="summary">Types of citation keys to expect.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.options">connectors.ZoteroWeb.options</a></td>
	<td class="summary">Zotero Web API options.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.mt">connectors.ZoteroWeb.mt</a></td>
	<td class="summary">Metatable for Zotero Web API connectors.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.mt.__call">connectors.ZoteroWeb.mt.__call ()</a></td>
	<td class="summary">Delegate to the Zotero Web API interface.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.mt.getters">connectors.ZoteroWeb.mt.getters</a></td>
	<td class="summary">Getters for Zotero Web API connectors.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.mt.getters.user_id">connectors.ZoteroWeb.mt.getters.user_id (obj)</a></td>
	<td class="summary">Get the user ID for the given API key.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb.mt.getters.groups">connectors.ZoteroWeb.mt.getters.groups (obj)</a></td>
	<td class="summary">Get the IDs of the groups the current user is a member of.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb:endpoints">connectors.ZoteroWeb:endpoints ([id])</a></td>
	<td class="summary">Iterate over item endpoint URLs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb:search">connectors.ZoteroWeb:search (...)</a></td>
	<td class="summary">Search items by their author, publication year, and title.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb:lookup">connectors.ZoteroWeb:lookup (id)</a></td>
	<td class="summary">Look up a CSL item by its Zotero ID.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connectors.ZoteroWeb:fetch">connectors.ZoteroWeb:fetch (ckey)</a></td>
	<td class="summary">Fetch a CSL item from Zotero.</td>
	</tr>
</table>
<h2><a href="#Main">Main </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#add_biblio">add_biblio (fname, handle, doc)</a></td>
	<td class="summary">Add data to a bibliography file and the file to the document&rsquo;s metadata.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#add_refs">add_refs (handle, doc)</a></td>
	<td class="summary">Add bibliographic data to the <code>references</code> metadata field.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#main">main (doc)</a></td>
	<td class="summary">Collect citations and add bibliographic data to the document.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Metadata"></a>Metadata </h2>

    <dl class="function">
    <dt>
    <a name = "NAME"></a>
    <strong>NAME</strong>
    </dt>
    <dd>
    The name of this script.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "VERSION"></a>
    <strong>VERSION</strong>
    </dt>
    <dd>
    The version of this script.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "SCRIPT_DIR"></a>
    <strong>SCRIPT_DIR</strong>
    </dt>
    <dd>
    The directory the script is located in.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "SCRIPT_NAME"></a>
    <strong>SCRIPT_NAME</strong>
    </dt>
    <dd>
    The filename of the script.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
</dl>
    <h2 class="section-header "><a name="Types"></a>Types </h2>

    <dl class="function">
    <dt>
    <a name = "type_match"></a>
    <strong>type_match (val, decl)</strong>
    </dt>
    <dd>
    <p>Check whether a value is of a type.</p>

<p> <h3>Type declaration grammar:</h3></p>

<p> Give one or more Lua type names separated by &lsquo;|&rsquo; to declare that the given
 value may be of any of those types (e.g., <code>'string|table'</code>). Use &lsquo;<code>*</code>&rsquo; to
 declare that the value may be of any type oter than <code>nil</code>. &lsquo;<code>?T</code>&rsquo; is short
 for &lsquo;<code>nil|T</code>&rsquo; (e.g., <code>'?table'</code> is equivalent to <code>'nil|table'</code>). &lsquo;<code>?*</code>&rsquo; is
 a special case; it signifies that the value may be of any type, even <code>nil</code>.</p>

<p> In <a href="https://en.wikipedia.org/wiki/EBNF">Extended Backus-Naur Form</a>:</p>

<blockquote><p>Type = &lsquo;boolean&rsquo; | &lsquo;function&rsquo; | &lsquo;nil&rsquo;    | &lsquo;number&rsquo;   |
       &lsquo;string&rsquo;  | &lsquo;table&rsquo;    | &lsquo;thread&rsquo; | &lsquo;userdata&rsquo;</p>

<p>List of types = (type, {&lsquo;|&rsquo;, type}) | &lsquo;*&rsquo;</p>

<p>Type declaration = [&lsquo;?&rsquo;], list of types</p></blockquote>

    <h3>Caveats:</h3>
    <ul>
         Wrong type names (e.g., &lsquo;int&rsquo;) do <em>not</em> raise an error.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">val</span>
         A value.
        </li>
        <li><span class="parameter">decl</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A type declaration (e.g., <code>'?number|string'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the value is of the declared type(s).
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> otherwise.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "typed_args"></a>
    <strong>typed_args (...)</strong>
    </dt>
    <dd>
    Type-check function arguments when running in debugging mode.</p>

<p> <h3>Type declaration grammar:</h3></p>

<p> The type declaration syntax is that of <a href="../index.html#type_match">type_match</a>, save for that
 you can use &lsquo;<code>...</code>&rsquo; to declare that an argument is of the same type
 as the previous one; if &lsquo;<code>...</code>&rsquo; is the last type declaration, then
 the previous type declaration applies to all remaning arguments.

    <h3>Caveats:</h3>
    <ul>
         Wrong type names do <em>not</em> raise an error on declaration.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Type declarations.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A function that adds type checks to a function.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">copy = typed_args(<span class="string">'?*'</span>, <span class="string">'?table'</span>)(
    <span class="keyword">function</span> (val, _seen)
        <span class="keyword">if</span> <span class="global">type</span>(val) ~= <span class="string">'table'</span> <span class="keyword">then</span> <span class="keyword">return</span> val <span class="keyword">end</span>
        <span class="keyword">if</span>     <span class="keyword">not</span> _seen  <span class="keyword">then</span> _seen = {}
        <span class="keyword">elseif</span> _seen[val] <span class="keyword">then</span> <span class="keyword">return</span> _seen[val]
        <span class="keyword">end</span>
        <span class="keyword">local</span> ret = <span class="global">setmetatable</span>({}, <span class="global">getmetatable</span>(val))
        _seen[val] = ret
        <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="global">next</span>, val <span class="keyword">do</span>
            <span class="global">rawset</span>(ret, copy(k, _seen), copy(v, _seen))
        <span class="keyword">end</span>
        <span class="keyword">return</span> ret
    <span class="keyword">end</span>
)</pre>
    </ul>

</dd>
    <dt>
    <a name = "typed_keyword_args"></a>
    <strong>typed_keyword_args (types)</strong>
    </dt>
    <dd>
    Type-check keyword arguments when running in debugging mode.

    <h3>Caveats:</h3>
    <ul>
         Wrong type names do <em>not</em> raise an error on declaration.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">types</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string=string,...}</a></span>
         A mapping of keywords
  to <a href="#type_match">type declarations</a>.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A function that adds type checks to a function.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">Foo = Object()
Foo.new = typed_keyword_args{
    bar = <span class="string">'number'</span>,
    baz = <span class="string">'?string'</span>
}(<span class="global">getmetatable</span>(Foo).__call)</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Meta_programming"></a>Meta-programming </h2>

    <dl class="function">
    <dt>
    <a name = "vars_get"></a>
    <strong>vars_get ([level=2])</strong>
    </dt>
    <dd>
    Get a copy of the variables that a function can access.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">level</span>
            <span class="types"><span class="type">int</span></span>
        <p> A stack level, where</p>

<ul>
<li>1 = <code>vars_get</code>,</li>
<li>2 = the function calling <code>vars_get</code>,</li>
<li>⋮</li>
<li><em>n</em> = the function calling the function at level <em>n</em> – 1.</li>
</ul>

         (<em>default</em> 2)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        A mapping of variable names to values.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if there is no function at that level of the stack.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="keyword">function</span> bar ()
&gt;     <span class="global">print</span>(get_vars(<span class="number">3</span>)[<span class="string">'foo'</span>])
&gt; <span class="keyword">end</span>
&gt; <span class="keyword">function</span> foo ()
&gt;     foo = <span class="string">'foo'</span>
&gt;     bar()
&gt; <span class="keyword">end</span>
&gt; foo()
foo</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Tables"></a>Tables </h2>

    <dl class="function">
    <dt>
    <a name = "ignore_case"></a>
    <strong>ignore_case</strong>
    </dt>
    <dd>
    A metatable to make tables ignore case.

    </ul>
    </ul>
    </ul>
    </ul>





    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; tab = <span class="global">setmetatable</span>({}, ignore_case)
&gt; tab.FOO = <span class="string">'bar'</span>
&gt; tab.foo
bar</pre>
    </ul>

</dd>
    <dt>
    <a name = "ignore_case.__index"></a>
    <strong>ignore_case.__index (tab, key)</strong>
    </dt>
    <dd>
    Look up an item.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
        </li>
        <li><span class="parameter">key</span>
         A key.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The item.
    </ol>




</dd>
    <dt>
    <a name = "ignore_case.__newindex"></a>
    <strong>ignore_case.__newindex (tab, key, val)</strong>
    </dt>
    <dd>
    Store a new item.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
        </li>
        <li><span class="parameter">key</span>
         A key.
        </li>
        <li><span class="parameter">val</span>
         A value.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "copy"></a>
    <strong>copy (val)</strong>
    </dt>
    <dd>
    Make a deep copy of a value.

    <h3>Caveats:</h3>
    <ul>
         Bypasses metamethods.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">val</span>
         A value.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        A deep copy.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; foo = {<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>}
&gt; bar = {foo, <span class="number">4</span>}
&gt; baz = copy(bar)
&gt; foo[#foo + <span class="number">1</span>] = <span class="number">4</span>
&gt; <span class="global">table</span>.<span class="global">unpack</span>(baz, <span class="number">1</span>)
<span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "keys"></a>
    <strong>keys (tab)</strong>
    </dt>
    <dd>
    Get the keys and the number of items in a table.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><span class="type">tab</span></span>
        The keys of the table.</li>
        <li>
           <span class="types"><span class="type">int</span></span>
        The number of items in the table.</li>
    </ol>




</dd>
    <dt>
    <a name = "order"></a>
    <strong>order (values)</strong>
    </dt>
    <dd>
    Define a sorting function from a list of values.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">values</span>
            <span class="types"><span class="type">tab</span></span>
         Values.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A sorting function.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; tab = {a = <span class="number">3</span>, b = <span class="number">4</span>, c = <span class="number">2</span>, d = <span class="number">1</span>}
&gt; <span class="keyword">for</span> k, v <span class="keyword">in</span> sorted(tab, order{<span class="string">'d'</span>, <span class="string">'c'</span>}) <span class="keyword">do</span>
&gt;     <span class="global">print</span>(k, v)
&gt; <span class="keyword">end</span>
d    <span class="number">1</span>
c    <span class="number">2</span>
a    <span class="number">3</span>
b    <span class="number">4</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "sorted"></a>
    <strong>sorted (tab[, func])</strong>
    </dt>
    <dd>
    Iterate over the key-value pairs of a table in a given order.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
        </li>
        <li><span class="parameter">func</span>
            <span class="types"><span class="type">func</span></span>
         A sorting function.
  If no function is given, sorts lexically.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A <em>stateful</em> iterator.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="keyword">for</span> k, v <span class="keyword">in</span> sorted{c = <span class="number">3</span>, b = <span class="number">2</span>, a = <span class="number">1</span>} <span class="keyword">do</span>
&gt;     <span class="global">print</span>(k, v)
&gt; <span class="keyword">end</span>
a    <span class="number">1</span>
b    <span class="number">2</span>
c    <span class="number">3</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "tabulate"></a>
    <strong>tabulate (iter[, tab[, key]])</strong>
    </dt>
    <dd>
    Tabulate the values an iterator returns.</p>

<p> The iterator must accept the same arguments as <a href="https://www.lua.org/manual/5.1/manual.html#pdf-next">next</a>.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">iter</span>
            <span class="types"><span class="type">func</span></span>
         An iterator.
        </li>
        <li><span class="parameter">tab</span>
         A table to iterate over.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">key</span>
         The index to start iterating at.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The values returned by the iterator.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; str = <span class="string">'key: value'</span>
&gt; k, v = tabulate(split(str, <span class="string">'%s*:%s*'</span>, <span class="number">2</span>))
&gt; <span class="global">print</span>(k, v)
key    value</pre>
    </ul>

</dd>
    <dt>
    <a name = "walk"></a>
    <strong>walk (val, func)</strong>
    </dt>
    <dd>
    Walk a graph and apply a function to every node.</p>

<p> A node is only changed if the function does <em>not</em> return <code>nil</code>.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">val</span>
         A value.
        </li>
        <li><span class="parameter">func</span>
            <span class="types"><span class="type">func</span></span>
         A function.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The transformed graph.
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Strings"></a>Strings </h2>

    <dl class="function">
    <dt>
    <a name = "split"></a>
    <strong>split (str, pattern[, max[, include]])</strong>
    </dt>
    <dd>
    Iterate over substrings of a string.

    <h3>Caveats:</h3>
    <ul>
         Supports neither multi-byte characters nor frontier patterns.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A string.
        </li>
        <li><span class="parameter">pattern</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Where to split the string.
        </li>
        <li><span class="parameter">max</span>
            <span class="types"><span class="type">int</span></span>
         Split the string into at most that many substrings.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">include</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Include separators in substrings?</p>

<ul>
<li><code>l</code> includes separators on the left,</li>
<li><code>r</code> on the right.</li>
</ul>


<p>  By default, separators are <em>not</em> included.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A <em>stateful</em> iterator.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="keyword">for</span> s <span class="keyword">in</span> split(<span class="string">'CamelCase'</span>, <span class="string">'%u'</span>, <span class="keyword">nil</span>, <span class="string">'l'</span>) <span class="keyword">do</span>
&gt;     <span class="global">print</span>(<span class="global">string</span>.format(<span class="string">"%s"</span>, s))
&gt; <span class="keyword">end</span>
<span class="string">""</span>
<span class="string">"Camel"</span>
<span class="string">"Case"</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "trim"></a>
    <strong>trim (str)</strong>
    </dt>
    <dd>
    Remove leading and trailing whitespace.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A string.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A trimmed string.
    </ol>




</dd>
    <dt>
    <a name = "vars_sub"></a>
    <strong>vars_sub (str, vars)</strong>
    </dt>
    <dd>
    <p>Substitute variables in strings.</p>

<p> If a string of characters is placed within braces (&lsquo;{&hellip;}&rsquo;) and the
 opening brace (&lsquo;{&rsquo;) immediately follows a single dollar (&lsquo;$&rsquo;) sign,
 then that string is treated as a variable name and the whole
 expression is replaced with the value of that variable.</p>

<pre><code>&gt; vars_sub(
&gt;     '${v1} is ${v2}.',
&gt;     {v1 = 'foo', v2 = 'bar'}
&gt; )
foo is bar.
</code></pre>

<p> If a braced string is preceded by two or more dollar signs, it is <em>not</em>
 <em>not</em> treated as a variable name and <em>not</em> replaced. Any series of <em>n</em>
 dollar signs is replaced with <em>n</em> – 1 dollar signs.</p>

<pre><code>&gt; vars_sub(
&gt;     '$${v1} costs $$23.',
&gt;     {v1 = 'foo'}
&gt; )
${v1} costs $23.
</code></pre>

<p> If a variable name is followed by a pipe symbol (&lsquo;|&rsquo;), then the string
 of characters between the pipe symbol and the closing brace (&lsquo;}&rsquo;) is
 treated as a function name; the value of the variable is then passed to
 that function, and the whole expression <code>${&lt;variable&gt;|&lt;function&gt;}</code> is
 replaced with the first value that this function returns. Variable
 names must <em>not</em> contain the pipe symbol, but function names may.</p>

<pre><code>&gt; vars_sub(
&gt;     '${v1|barify} is bar!', {
&gt;         v1 = 'foo',
&gt;         barify = function (s)
&gt;             return s:gsub('foo', 'bar')
&gt;         end
&gt;     }
&gt; )
bar is bar!
</code></pre>

<p> You can lookup values in tables by joining the name of the variable
 and that of the table index with a dot (&lsquo;.&rsquo;). Neither variable nor
 function names may contain dots.</p>

<pre><code>&gt; vars_sub(
&gt;     '${foo.bar} is baz.', {
&gt;         foo = { bar = 'baz' }
&gt;     }
&gt; )
baz is baz.
</code></pre>

<p> Expressions are evaluated recursively.</p>

<pre><code>&gt; vars_sub(
&gt;     '${foo} is bar.', {
&gt;         foo = '${bar}',
&gt;         bar = 'baz'
&gt;     }
&gt; )
baz is bar.
</code></pre>

    <h3>Caveats:</h3>
    <ul>
         <ul>
<li><p>If there is no variable of a given name,
the expression is quietly replaced with <code>nil</code>.</p>

<pre><code>&gt; vars_sub('foo is ${bar}.', {})
foo is nil.
</code></pre></li>
<li><p>The empty string is a valid variable name.</p>

<pre><code>&gt; vars_sub('foo is ${}.', {[''] = bar})
foo is bar.
</code></pre></li>
<li><p>Error messages are cryptic.</p></li>
</ul>

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A string.
        </li>
        <li><span class="parameter">vars</span>
            <span class="types"><span class="type">tab</span></span>
         Variables.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A transformed string.
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Basic_prototypes"></a>Basic prototypes </h2>

    <dl class="function">
    <dt>
    <a name = "Object"></a>
    <strong>Object</strong>
    </dt>
    <dd>
    Base prototype.

    </ul>
    </ul>
    </ul>
    </ul>





    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="comment">-- Delegate to Object.
</span>&gt; Foo = Object()
&gt; mt = <span class="global">getmetatable</span>(Foo)
&gt; mt.__tostring = <span class="keyword">function</span> () <span class="keyword">return</span> <span class="string">'foo'</span> <span class="keyword">end</span>
&gt; Foo.bar = <span class="string">'bar'</span>
&gt; <span class="comment">-- Objects inherit the prototype's properties.
</span>&gt; foo = Foo()
&gt; <span class="global">tostring</span>(obj)
foo
&gt; foo.bar
bar
&gt; <span class="comment">-- The prototype's metatable is copied, so
</span>&gt; <span class="comment">-- changing it does not alter a delegating object's behaviour.
</span>&gt; mt.__tostring = <span class="keyword">function</span> () <span class="keyword">return</span> <span class="string">'baz'</span> <span class="keyword">end</span>
&gt; <span class="global">tostring</span>(obj)
foo
&gt; <span class="comment">-- But changing non-overriden properties does.
</span>&gt; Foo.bar = <span class="string">'baz'</span>
&gt; foo.bar
baz
&gt; <span class="comment">-- The object can override properties, of course.
</span>&gt; foo.bar = <span class="string">'bam!'</span>
&gt; foo.bar
bam!
&gt; <span class="comment">-- And objects can be prototypes.
</span>&gt; bar = foo()
&gt; bar.bar
bam!</pre>
    </ul>

</dd>
    <dt>
    <a name = "Object.mt"></a>
    <strong>Object.mt</strong>
    </dt>
    <dd>
    Metatable for prototypes.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "Object.mt.__call"></a>
    <strong>Object.mt.__call (proto[, tab])</strong>
    </dt>
    <dd>
    Delegate to a prototype.</p>

<p> Set a table&rsquo;s metatable to a copy of the prototype&rsquo;s metatable
 and then set the <code>__index</code> field of that metatable to the prototype.

    <h3>Caveats:</h3>
    <ul>
         If a table is given, it is modified <em>in-place</em>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">proto</span>
            <span class="types"><span class="type">tab</span></span>
         A prototype.
        </li>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../index.html#Object">Object</a></span>
        An object.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; foo = Object{foo = <span class="string">'foo'</span>, bar = <span class="string">'bar'</span>}
&gt; foo.foo
foo
&gt; foo.bar
bar
&gt; bar = foo{bar = <span class="string">'bam!'</span>}
&gt; bar.foo
foo
&gt; bar.bar
bam!</pre>
    </ul>

</dd>
    <dt>
    <a name = "Object.new"></a>
    <strong>Object.new</strong>
    </dt>
    <dd>
    Initialise a new object.</p>

<p> <code>Object:new(props)</code> is equivalent to <code>Object(copy(props))</code>.

    </ul>
    </ul>
    </ul>
    </ul>

    <ul>
        <li><span class="parameter">proto</span>
            <span class="types"><span class="type">tab</span></span>
         A prototype.
        </li>
        <li><span class="parameter">props</span>
            <span class="types"><span class="type">tab</span></span>
         Properties.
         (<em>optional</em>)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; foo = Object:new{foo = <span class="string">'foo'</span>, bar = <span class="string">'bar'</span>}
&gt; foo.foo
foo
&gt; foo.bar
bar</pre>
    </ul>

</dd>
    <dt>
    <a name = "Values"></a>
    <strong>Values</strong>
    </dt>
    <dd>
    A simple list.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Object">Object</a>
    </ul>





    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; list = Values()
&gt; list:add <span class="string">'a string'</span>
&gt; list.n
<span class="number">1</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "Values.n"></a>
    <strong>Values.n</strong>
    </dt>
    <dd>
    The number of items in the list.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "Values:add"></a>
    <strong>Values:add (...)</strong>
    </dt>
    <dd>
    Add items to the list.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         Sets <a href="../index.html#Values.n">Values.n</a> to the number of items in the list.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
         Items.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "getterify"></a>
    <strong>getterify (tab)</strong>
    </dt>
    <dd>
    Add getters to a table.</p>

<p> <h3>Getter protocol:</h3></p>

<p> If an index is not present in a the table, look for a function of the same
 name in the table&rsquo;s <code>getters</code> metavalue. That metavalue must be a mapping
 of indices to functions. If it contains a function of the same name as the
 index, then that function is called with the table as only argument and
 whatever it returns is returned as the value for the index. If <code>getters</code>
 contains no function of that name, the name is looked up in the table&rsquo;s
 <code>__index</code> metavalue.

    <h3>Caveats:</h3>
    <ul>
         <ul>
<li>Tables are modified <em>in-place</em>.</li>
<li>Getters are <em>not</em> inherited.</li>
</ul>

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        The table.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="comment">-- Enable getters for an object.
</span>&gt; foo = getterify(Object{foo = <span class="string">'bar'</span>})
&gt; mt = <span class="global">getmetatable</span>(foo)
&gt; mt.getters = {}
&gt; <span class="keyword">function</span> mt.getters.bar () <span class="keyword">return</span> self.foo <span class="keyword">end</span>
&gt; foo.bar
bar
&gt; <span class="comment">-- The getter is reached via the prototype chain,
</span>&gt; <span class="comment">-- so it sees foo.foo, not bar.foo:
</span>&gt; baz = foo{foo = <span class="string">'bam!'</span>}
&gt; baz.bar
bar
&gt; <span class="comment">-- But you can make getters quasi-inheritable:
</span>&gt; mt.__call = delegate_with_getters
&gt; baz = foo{foo = <span class="string">'bam!'</span>}
&gt; baz.bar
bam!</pre>
    </ul>

</dd>
    <dt>
    <a name = "delegate_with_getters"></a>
    <strong>delegate_with_getters (proto[, tab])</strong>
    </dt>
    <dd>
    Delegate to a prototype and add getters.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">proto</span>
            <span class="types"><span class="type">tab</span></span>
         A prototype.
        </li>
        <li><span class="parameter">tab</span>
            <span class="types"><span class="type">tab</span></span>
         A table.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../index.html#Object">Object</a></span>
        A getterified table.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../index.html#getterify">getterify</a>
    </ul>


</dd>
</dl>
    <h2 class="section-header "><a name="Warnings"></a>Warnings </h2>

    <dl class="function">
    <dt>
    <a name = "xwarn"></a>
    <strong>xwarn (...)</strong>
    </dt>
    <dd>
    Print a message to STDERR.</p>

<p> <h3>Printout:</h3></p>

<p> The message is prefixed with <code>SCRIPT_NAME .. ': '</code> and terminated
 with <a href="../index.html#EOL">EOL</a>. Non-string values are coerced to strings.</p>

<p> <h3>Message priority:</h3></p>

<p> Messages are only printed if their priority is equal to or greater than
 <code>PANDOC_STATE.verbostiy</code>, where &lsquo;error&rsquo; > &lsquo;warning&rsquo; > &lsquo;info&rsquo;.</p>

<p> <h3>Variable substitution:</h3></p>

<p> If string values contain variable names, they are replaced with the
 values of those variables as seen by the function calling <code>xwarn</code>.
 See <a href="../index.html#vars_sub">vars_sub</a> for the syntax.</p>

<p> <h3>Options:</h3></p>

<p> String values that start with an &lsquo;@&rsquo; are interpreted as options:</p>

<ul>
<li><code>'@error'</code>, <code>'@warning'</code>, <code>'@info'</code>: Set the message&rsquo;s
priority. (<em>default</em> &lsquo;warning&rsquo;)</li>
<li><code>'@novars'</code>: Turn variable substitution off. (<em>default</em> on)</li>
<li><code>'@vars'</code>: Turn variable substitution on.</li>
<li><code>'@noopts'</code>: Turn option processing off. (<em>default</em> on)</li>
<li><code>'@plain'</code>: Turn variable substitution <em>and</em> option processing off.</li>
</ul>


<p> Unknown options are ignored.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
         Messages. At least one must be given.
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="File_I_O"></a>File I/O </h2>

    <dl class="function">
    <dt>
    <a name = "PATH_SEP"></a>
    <strong>PATH_SEP</strong>
    </dt>
    <dd>
    The path segment separator used by the operating system.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "EOL"></a>
    <strong>EOL</strong>
    </dt>
    <dd>
    The end of line sequence used on the given operating system.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "path_join"></a>
    <strong>path_join (...)</strong>
    </dt>
    <dd>
    Join multiple path segments.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Path segments.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A path.
    </ol>




</dd>
    <dt>
    <a name = "path_normalise"></a>
    <strong>path_normalise (path)</strong>
    </dt>
    <dd>
    Normalise a path.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A path.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A normalised path.
    </ol>




</dd>
    <dt>
    <a name = "path_split"></a>
    <strong>path_split (path)</strong>
    </dt>
    <dd>
    Split a path into a directory and a filename.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A path.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The directory the file is in.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The file&rsquo;s name.</li>
    </ol>




</dd>
    <dt>
    <a name = "path_is_abs"></a>
    <strong>path_is_abs (path)</strong>
    </dt>
    <dd>
    Check whether a path is absolute.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A path.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the path is absolute, <code>false</code> otherwise.
    </ol>




</dd>
    <dt>
    <a name = "path_prettify"></a>
    <strong>path_prettify (path)</strong>
    </dt>
    <dd>
    Prettify paths.</p>

<p> Removes the working directory from the beginning of the path. On
 non-Windows systems, also replaces the user&rsquo;s home directory with &lsquo;~&rsquo;.

    </ul>
    </ul>
    <h3>Requires:</h3>
    <ul>
          The working directory is removed from the
  beginning of the path since Pandoc v2.12.
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A path.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A prettier path.
    </ol>




</dd>
    <dt>
    <a name = "wd"></a>
    <strong>wd ()</strong>
    </dt>
    <dd>
    Get a directory to use as working directory.

    </ul>
    </ul>
    </ul>
    </ul>


    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The directory of the first input file
  or &lsquo;.&rsquo; if no input files were given.
    </ol>




</dd>
    <dt>
    <a name = "file_exists"></a>
    <strong>file_exists (fname)</strong>
    </dt>
    <dd>
    Check whether a file exists.

    <h3>Caveats:</h3>
    <ul>
          Another process may create a file of the given name between the time
 <code>file_exists</code> tries to access that file and the time it returns.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">boolean</span></span>
        <code>true</code> if the file exists.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the file does not exist.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">int</span></span>
        The error number 2.</li>
    </ol>

    <h3>Raises:</h3>
    An error if the file cannot be closed again.



</dd>
    <dt>
    <a name = "file_locate"></a>
    <strong>file_locate (fname)</strong>
    </dt>
    <dd>
    Locate a file in Pandoc&rsquo;s resource path.

    <h3>Caveats:</h3>
    <ul>
         Absolute filenames are returned as is.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A filename in Pandoc&rsquo;s resource path.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the file could not be found.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "file_read"></a>
    <strong>file_read (fname)</strong>
    </dt>
    <dd>
    Read a file.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The contents of the file.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">int</span></span>
        An error number.</li>
    </ol>




</dd>
    <dt>
    <a name = "file_write"></a>
    <strong>file_write (fname, ...)</strong>
    </dt>
    <dd>
    Write data to a file.</p>

<p> If a file of that name already exists, it is overwritten.

    <h3>Caveats:</h3>
    <ul>
          Data is first written to a temporary file, that file is then renamed
 to the given filename. This is safe and secure starting with Pandoc
 v2.8. If you are using an older version of Pandoc, the caveats of
 <a href="../index.html#with_tmp_file">with_tmp_file</a> apply.
    </ul>
    <h3>Side-effects:</h3>
    <ul>
         Typically creates and deletes a temporary file.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The data.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the data was written to the given file.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">int</span></span>
        An error number.</li>
    </ol>




</dd>
    <dt>
    <a name = "tmp_fname"></a>
    <strong>tmp_fname ([dir[, templ='pdz-XXXXXX']])</strong>
    </dt>
    <dd>
    Generate a name for a temporary file.

    <h3>Caveats:</h3>
    <ul>
          The filename generated is only <em>likely</em> not to be in use. Another
 process may create a file of the same name between the time <code>tmp_fname</code>
 checks whether that name is in use and the time it returns.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">dir</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A directory to prefix the filename with.
  Must <em>not</em> be the empty string.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">templ</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A template for the filename.
  &lsquo;X&rsquo;s are replaced with random alphanumeric characters.
  Must contain at least six 'X&rsquo;s.
         (<em>default</em> 'pdz-XXXXXX')
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A filename.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the generated filename is in use.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "with_tmp_file"></a>
    <strong>with_tmp_file (func[, dir[, templ]])</strong>
    </dt>
    <dd>
    Run a function with a temporary file.</p>

<p> Generates a temporary filename. Does <em>not</em> create that file.
 If the function raises an error or returns <code>nil</code> or <code>false</code>,
 the temporary file is deleted.

    <h3>Caveats:</h3>
    <ul>
          The temporary file may have been created by <em>another</em> process. If that
 file is located within a directory that other users have write access
 to (e.g., <code>/tmp</code>), then this is a security issue.
    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">func</span>
            <span class="types"><span class="type">func</span></span>
         Given the name of the temporary file.
  Must <em>not</em> change the working directory.
        </li>
        <li><span class="parameter">dir</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A directory to prefix the name
  of the temporary file with. See <a href="../index.html#tmp_fname">tmp_fname</a>.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">templ</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A template for the name
  of the temporary file. See <a href="../index.html#tmp_fname">tmp_fname</a>.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The values returned by the function.
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Networking"></a>Networking </h2>

    <dl class="function">
    <dt>
    <a name = "http_get"></a>
    <strong>http_get (url)</strong>
    </dt>
    <dd>
    Retrieve data from a URL via an HTTP GET request.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">url</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The URL.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The MIME type of the HTTP content.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The HTTP content itself.</li>
    </ol>

    <h3>Raises:</h3>
     An error if the host cannot be reached.
  This error can only be caught since Pandoc v2.11.



</dd>
    <dt>
    <a name = "url_query"></a>
    <strong>url_query (url[, params])</strong>
    </dt>
    <dd>
    Query a URL via an HTTP GET request.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">url</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The URL.
        </li>
        <li><span class="parameter">params</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string=string,...}</a></span>
         Request parameters.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The MIME type of the HTTP content.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The HTTP content itself.</li>
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#http_get">http_get</a>.


    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; <span class="comment">-- Query &lt;https://site.example?foo=1&amp;bar=2&gt;.
</span>mt, con = url_query(<span class="string">'https://site.example'</span>, {foo = <span class="number">1</span>, bar = <span class="number">2</span>})</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Markup_converters"></a>Markup converters </h2>

    <dl class="function">
    <dt>
    <a name = "escape_markdown"></a>
    <strong>escape_markdown (str)</strong>
    </dt>
    <dd>
    Escape Markdown syntax.

    <h3>Caveats:</h3>
    <ul>
          Only escapes <a href="https://pandoc.org/MANUAL.html#specifying-bibliographic-data">Markdown that Pandoc recognises in bibliographic
 data</a>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Non-markdown text.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Text with markdown syntax escaped.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; escape_markdown <span class="string">'*text*'</span>
\*text*</pre>
    </ul>

</dd>
    <dt>
    <a name = "markdownify"></a>
    <strong>markdownify (elem)</strong>
    </dt>
    <dd>
    Convert a Pandoc element to Markdown text.

    <h3>Caveats:</h3>
    <ul>
          Only recognises <a href="https://pandoc.org/MANUAL.html#specifying-bibliographic-data">elements Pandoc permits in bibliographic
 data</a>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">elem</span>
            <span class="types"><span class="type">pandoc.AstElement</span></span>
         A Pandoc AST element.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Markdown text.
    </ol>




</dd>
    <dt>
    <a name = "yamlify"></a>
    <strong>yamlify (val[, ind=4[, sort]])</strong>
    </dt>
    <dd>
    Generate a YAML representation of a value.</p>

<p> Lines are termined with <a href="../index.html#EOL">EOL</a>.

    <h3>Caveats:</h3>
    <ul>
         <ul>
<li>Mangles strings in encodings other than UTF-8.</li>
<li>Does <em>not</em> escape <em>all</em> non-printable characters (because Unicode).</li>
</ul>

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">val</span>
         A value.
        </li>
        <li><span class="parameter">ind</span>
            <span class="types"><span class="type">int</span></span>
         How many spaces to indent blocks.
         (<em>default</em> 4)
        </li>
        <li><span class="parameter">sort</span>
            <span class="types"><span class="type">func</span></span>
         A function to sort keys of mappings.
  Defaults to lexical sorting.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A YAML string.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the data cannot be represented in YAML.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "zotero_to_html"></a>
    <strong>zotero_to_html (pseudo)</strong>
    </dt>
    <dd>
    Convert Zotero pseudo-HTML to proper HTML.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pseudo</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Zotero pseudo-HTML code.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        HTML code.
    </ol>

    <h3>Raises:</h3>
    An error if opening <code>&lt;sc&gt;</code> and closing <code>&lt;/sc&gt;</code> tags are unbalanced.



</dd>
    <dt>
    <a name = "zotero_to_markdown"></a>
    <strong>zotero_to_markdown (pseudo)</strong>
    </dt>
    <dd>
    Convert Zotero pseudo-HTML to Markdown.

    <h3>Caveats:</h3>
    <ul>
          Only supports <a href="https://pandoc.org/MANUAL.html#specifying-bibliographic-data">pseudo-HTML that Pandoc recognises in bibliographic
 data</a>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pseudo</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Zotero pseudo-HTML code.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Markdown text.
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#zotero_to_html">zotero_to_html</a>.



</dd>
</dl>
    <h2 class="section-header has-description"><a name="CSL_items"></a>CSL items </h2>

          <div class="section-description">
           <a href="https://perma.cc/7LPL-F4XD">Appendix IV</a> of the Citation Style Language
 (CSL) specification lists all CSL variable names.
          </div>
    <dl class="function">
    <dt>
    <a name = "CSL_VARS_ORDER"></a>
    <strong>CSL_VARS_ORDER</strong>
    </dt>
    <dd>
    Preferred order of CSL variables.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">id</span>
        Item ID.
        </li>
        <li><span class="parameter">type</span>
        For example, &lsquo;paper&rsquo;, &lsquo;book&rsquo;.
        </li>
        <li><span class="parameter">author</span>
        Author(s).
        </li>
        <li><span class="parameter">original-author</span>
        Original author(s).
        </li>
        <li><span class="parameter">recipient</span>
        Recipient of the document.
        </li>
        <li><span class="parameter">status</span>
        Publication status (e.g., &lsquo;forthcoming&rsquo;).
        </li>
        <li><span class="parameter">issued</span>
        When the item was published.
        </li>
        <li><span class="parameter">original-date</span>
        Original date.
        </li>
        <li><span class="parameter">title</span>
        The title.
        </li>
        <li><span class="parameter">title-short</span>
        A short version of the title.
        </li>
        <li><span class="parameter">short-title</span>
        Ditto.
        </li>
        <li><span class="parameter">translator</span>
        Translator(s).
        </li>
        <li><span class="parameter">editor</span>
        The editor(s).
        </li>
        <li><span class="parameter">container-title</span>
        Publication the item was published in.
        </li>
        <li><span class="parameter">container-title-short</span>
        A short version of that title.
        </li>
        <li><span class="parameter">collection-title</span>
        E.g., a series.
        </li>
        <li><span class="parameter">collection-title-short</span>
        A short version of the title.
        </li>
        <li><span class="parameter">edition</span>
        Container&rsquo;s edition.
        </li>
        <li><span class="parameter">volume</span>
        Volume no.
        </li>
        <li><span class="parameter">issue</span>
        Issue no.
        </li>
        <li><span class="parameter">page-first</span>
        First page.
        </li>
        <li><span class="parameter">page</span>
        Pages or page range <em>or</em> number of pages.
        </li>
        <li><span class="parameter">publisher</span>
        Publisher.
        </li>
        <li><span class="parameter">publisher-place</span>
        City/cities the item was published in.
        </li>
        <li><span class="parameter">original-title</span>
        Original title.
        </li>
        <li><span class="parameter">original-publisher</span>
        Original publisher.
        </li>
        <li><span class="parameter">original-publisher-place</span>
        Place the item was originally published in.
        </li>
        <li><span class="parameter">doi</span>
        The DOI.
        </li>
        <li><span class="parameter">pmcid</span>
        PubMed Central reference number.
        </li>
        <li><span class="parameter">pmid</span>
        PubMed reference number.
        </li>
        <li><span class="parameter">url</span>
        The URL.
        </li>
        <li><span class="parameter">accessed</span>
        When the URL was last accessed.
        </li>
        <li><span class="parameter">isbn</span>
        The ISBN of the item.
        </li>
        <li><span class="parameter">issn</span>
        The ISSN of the container.
        </li>
        <li><span class="parameter">call-number</span>
        Call number (of a library).
        </li>
        <li><span class="parameter">language</span>
        Language the item is in.
        </li>
        <li><span class="parameter">abstract</span>
        The abstract.
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="../index.html#csl_vars_sort">csl_vars_sort</a>
    </ul>


</dd>
    <dt>
    <a name = "csl_item_extras"></a>
    <strong>csl_item_extras (item)</strong>
    </dt>
    <dd>
    Iterate over every key-value pair in the &ldquo;note&rdquo; field of a CSL item.

    <h3>Caveats:</h3>
    <ul>
          Assumes that the &ldquo;note&rdquo; field is used to store entries that
 were added to Zotero&rsquo;s <a href="https://perma.cc/EGN3-78CH">&ldquo;extra&rdquo; field</a>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>
            <span class="types"><span class="type">tab</span></span>
         A CSL item.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A <em>stateful</em> iterator.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../index.html#csl_item_add_extras">csl_item_add_extras</a>
    </ul>


</dd>
    <dt>
    <a name = "csl_item_add_extras"></a>
    <strong>csl_item_add_extras (item)</strong>
    </dt>
    <dd>
    Add CSL variables from the &ldquo;note&rdquo; field to the item proper.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>
            <span class="types"><span class="type">tab</span></span>
         A CSL item.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        The item with variables from &ldquo;extra&rdquo; copied.
    </ol>




</dd>
    <dt>
    <a name = "csl_item_normalise_vars"></a>
    <strong>csl_item_normalise_vars (item)</strong>
    </dt>
    <dd>
    Normalise variable names of a CSL item.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>
            <span class="types"><span class="type">tab</span></span>
         A CSL item.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        A normalised item.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../index.html#csl_varname_normalise">csl_varname_normalise</a>
    </ul>


</dd>
    <dt>
    <a name = "csl_item_to_meta"></a>
    <strong>csl_item_to_meta (item)</strong>
    </dt>
    <dd>
    Convert a CSL item to a Pandoc metadata value.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">item</span>
            <span class="types"><span class="type">tab</span></span>
         A CSL item.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.MetaMap</span></span>
        A Pandoc metadata value.
    </ol>

    <h3>Raises:</h3>
     An error if an item cannot be converted to
  a Pandoc metadata value.



</dd>
    <dt>
    <a name = "csl_items_filter_by_ckey"></a>
    <strong>csl_items_filter_by_ckey (items, ckey)</strong>
    </dt>
    <dd>
    Filter CSL items by their citation key.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">items</span>
            <span class="types"><span class="type">{tab,...}</span></span>
         CSL items.
        </li>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A citation key (e.g., <code>'doe:2020word'</code>, <code>'DoeWord2020'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">{tab,...}</span></span>
        Items with that citation key.
    </ol>




</dd>
    <dt>
    <a name = "csl_items_ids"></a>
    <strong>csl_items_ids (items)</strong>
    </dt>
    <dd>
    Pick the IDs of CSL items out of a list of CSL items.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">items</span>
            <span class="types"><span class="type">{tab,...}</span></span>
         CSL items.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{[string]=true,...}</a></span>
          A <a href="https://www.lua.org/pil/11.5.html">set</a> of item IDs.
    </ol>




</dd>
    <dt>
    <a name = "csl_items_sort"></a>
    <strong>csl_items_sort (a, b)</strong>
    </dt>
    <dd>
    Sort CSL items by their ID.

    <h3>Caveats:</h3>
    <ul>
         Assumes that CSL item IDs are of the same type.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">a</span>
            <span class="types"><span class="type">tab</span></span>
         A CSL item.
        </li>
        <li><span class="parameter">b</span>
            <span class="types"><span class="type">tab</span></span>
         Another CSL item.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        Whether item A comes before item B.
    </ol>




</dd>
    <dt>
    <a name = "csl_varname_normalise"></a>
    <strong>csl_varname_normalise (var)</strong>
    </dt>
    <dd>
    Normalise a CSL variable name.</p>

<p> Trim the variable name, lowercase it, and replace spaces with dashes.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">var</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A CSL variable name.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A normalised variable name.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the string is not a CSL variable name.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; csl_varname_normalise <span class="string">'Original date'</span>
original-date</pre>
    </ul>

</dd>
    <dt>
    <a name = "csl_vars_sort"></a>
    <strong>csl_vars_sort (a, b)</strong>
    </dt>
    <dd>
    Sort CSL variables.</p>

<p> Sorts variables in the order in which they are listed in <a href="../index.html#CSL_VARS_ORDER">CSL_VARS_ORDER</a>.
 Unlisted variables are placed after listed ones in lexical order.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">a</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A CSL variable name.
        </li>
        <li><span class="parameter">b</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Another CSL variable name.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        Whether variable A should come before variable B.
    </ol>




</dd>
    <dt>
    <a name = "csl_json_to_items"></a>
    <strong>csl_json_to_items (str)</strong>
    </dt>
    <dd>
    Parse a CSL JSON string.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A CSL JSON string.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        A single CSL item or a list of CSL items.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the string cannot be parsed.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Citation_keys"></a>Citation keys </h2>

    <dl class="function">
    <dt>
    <a name = "citekey"></a>
    <strong>citekey</strong>
    </dt>
    <dd>
    An interface for parsing citation keys.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Object">Object</a>
    </ul>






</dd>
    <dt>
    <a name = "citekey.parsers"></a>
    <strong>citekey.parsers</strong>
    </dt>
    <dd>
    A mapping of citation key types to parsers.</p>

<p> A parser must take a citation key and return search terms or <code>nil</code> and
 an error message if no search terms can be derived from the citation key.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "citekey.parsers.betterbibtexkey"></a>
    <strong>citekey.parsers.betterbibtexkey (ckey)</strong>
    </dt>
    <dd>
    Guess search terms from a BetterBibTeX citation key.</p>

<p> Splits up a BetterBibTeX citation key at each uppercase letter
 and at each start of a string of digits.

    <h3>Caveats:</h3>
    <ul>
         BetterBibTeX citation keys must be encoded in ASCII.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A BetterBibTeX citation key (e.g., <code>'DoeWord2020'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
        Search terms.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no search terms could be derived.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "Citekey.parsers.easykey"></a>
    <strong>Citekey.parsers.easykey (ckey)</strong>
    </dt>
    <dd>
    Guess search terms from an Easy Citekey.</p>

<p> Splits up an Easy Citekey into an author, a year, and a word.

    <h3>Caveats:</h3>
    <ul>
         Easy Citekeys must be encoded in UTF-8.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A zotxt Easy Citekey (e.g., <code>'doe:2020word'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
        Search terms.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no search terms could be derived.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "citekey:guess_terms"></a>
    <strong>citekey:guess_terms (ckey, types)</strong>
    </dt>
    <dd>
    Guess search terms from a citation key.

    <h3>Caveats:</h3>
    <ul>
          The citation key types &lsquo;key&rsquo; and &lsquo;easykey&rsquo; go before &lsquo;betterbibtexkey&rsquo;,
 for while it is unlikely for the Zotero item ID parser or the Easy Citekey
 parser to parse a Better BibTeX citation key, it is possible for the
 BetterBibTeX citation parser to parse a Zotero item ID and quite likely
 for it to parse an Easy Citekey &ndash; and it would do it wrong.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A citation key (e.g., <code>'doe:2020word'</code>, <code>'DoeWord2020'</code>).
        </li>
        <li><span class="parameter">types</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
         Types to try to parse the citation key as.
  If <a href="../index.html#citekey.parsers">citekey.parsers</a> contains no parser for a type, it is ignored.
  Order is significant.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
        Search terms.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no search terms could be derived.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Bibliography_files"></a>Bibliography files </h2>

    <dl class="function">
    <dt>
    <a name = "biblio"></a>
    <strong>biblio</strong>
    </dt>
    <dd>
    An interface for reading, writing, and updating bibliography files.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Object">Object</a>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types"></a>
    <strong>biblio.types</strong>
    </dt>
    <dd>
    A case-insensitive mapping of filename suffices to codecs.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types.bib"></a>
    <strong>biblio.types.bib</strong>
    </dt>
    <dd>
    Decode BibLaTeX.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types.bib.decode"></a>
    <strong>biblio.types.bib.decode (str)</strong>
    </dt>
    <dd>
    Read the IDs from the contents of a BibLaTeX file.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The contents of a BibLaTeX file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">{{['id']=string},...}</span></span>
        Key-value pairs.
    </ol>




</dd>
    <dt>
    <a name = "biblio.types.bibtex"></a>
    <strong>biblio.types.bibtex</strong>
    </dt>
    <dd>
    Decode BibTeX.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types.bibtex.decode"></a>
    <strong>biblio.types.bibtex.decode (str)</strong>
    </dt>
    <dd>
    Read the IDs from the contents of a BibTeX file.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The contents of a BibTeX file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">{{['id']=string},...}</span></span>
        Key-value pairs.
    </ol>




</dd>
    <dt>
    <a name = "biblio.types.json"></a>
    <strong>biblio.types.json</strong>
    </dt>
    <dd>
    De-/Encode CSL items in JSON.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types.json.decode"></a>
    <strong>biblio.types.json.decode (str)</strong>
    </dt>
    <dd>
    Parse a CSL JSON string.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A CSL JSON file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">{tab,...}</span></span>
        CSL items.
    </ol>




</dd>
    <dt>
    <a name = "biblio.types.json.encode"></a>
    <strong>biblio.types.json.encode (items)</strong>
    </dt>
    <dd>
    Serialise a list of CSL items to a JSON string.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">items</span>
            <span class="types"><span class="type">{tab,...}</span></span>
         CSL items.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A CSL YAML string.
    </ol>




</dd>
    <dt>
    <a name = "biblio.types.yaml"></a>
    <strong>biblio.types.yaml</strong>
    </dt>
    <dd>
    De-/Encode CSL items in YAML.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio.types.yaml.decode"></a>
    <strong>biblio.types.yaml.decode (str)</strong>
    </dt>
    <dd>
    Parse a CSL YAML string.

    <h3>Caveats:</h3>
    <ul>
         Converts formatting to Markdown, not Zotero pseudo-HTML.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A CSL YAML string.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">{tab,...}</span></span>
        CSL items.
    </ol>




</dd>
    <dt>
    <a name = "biblio.types.yaml.encode"></a>
    <strong>biblio.types.yaml.encode (items)</strong>
    </dt>
    <dd>
    Serialise a list of CSL items to a YAML string.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">items</span>
            <span class="types"><span class="type">{tab,...}</span></span>
         CSL items.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A CSL YAML string.
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#yamlify">yamlify</a> and <a href="../index.html#zotero_to_markdown">zotero_to_markdown</a>.



</dd>
    <dt>
    <a name = "biblio.types.yml"></a>
    <strong>biblio.types.yml</strong>
    </dt>
    <dd>
    Alternative suffix for YAML files.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "biblio:read"></a>
    <strong>biblio:read (fname)</strong>
    </dt>
    <dd>
    Read a bibliography file.</p>

<p> The filename suffix determines the file&rsquo;s format.
 <a href="../index.html#biblio.types">biblio.types</a> must contain a matching decoder.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        CSL items.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types">optional <span class="type">int</span></span>
        An error number if the error is an I/O error.</li>
    </ol>




</dd>
    <dt>
    <a name = "biblio:write"></a>
    <strong>biblio:write (fname[, items])</strong>
    </dt>
    <dd>
    Write bibliographic data to a bibliography file.</p>

<p> The filename suffix determines the file&rsquo;s format.
 <a href="../index.html#biblio.types">biblio.types</a> must contain a matching encoder.

    <h3>Caveats:</h3>
    <ul>
         See <a href="../index.html#file_write">file_write</a>.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename.
        </li>
        <li><span class="parameter">items</span>
            <span class="types"><span class="type">tab</span></span>
         CSL items. If none are given, tests
  whether the data can be written in the given format.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        The filename suffix.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types">optional <span class="type">int</span></span>
        An error number if the error is an I/O error.</li>
    </ol>




</dd>
    <dt>
    <a name = "biblio:update"></a>
    <strong>biblio:update (handle, fname, ckeys)</strong>
    </dt>
    <dd>
    Add new items from Zotero to a bibliography file.

    <h3>Caveats:</h3>
    <ul>
         See <a href="../index.html#file_write">file_write</a>.
    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">handle</span>
            <span class="types"><a class="type" href="../index.html#connectors.Zotero">connectors.Zotero</a> or <a class="type" href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a></span>
         A Zotero interface.
        </li>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         The name of the bibliography file.
        </li>
        <li><span class="parameter">ckeys</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
         The citation keys of the items to add
  (e.g., <code>{'doe:2020word'}</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the file was updated or no update was required.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurrs.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types">optional <span class="type">int</span></span>
        An error number if the error is a file I/O error.</li>
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#http_get">http_get</a>.



</dd>
</dl>
    <h2 class="section-header "><a name="Document_parsing"></a>Document parsing </h2>

    <dl class="function">
    <dt>
    <a name = "elem_clone"></a>
    <strong>elem_clone (elem)</strong>
    </dt>
    <dd>
    Make a shallow copy of a Pandoc AST element.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">elem</span>
            <span class="types"><span class="type">pandoc.AstElement</span></span>
         A Pandoc AST element.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.AstElement</span></span>
        The clone.
    </ol>




</dd>
    <dt>
    <a name = "elem_type"></a>
    <strong>elem_type (elem)</strong>
    </dt>
    <dd>
    Get the type of a Pandoc AST element.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">elem</span>
            <span class="types"><span class="type">pandoc.AstElement</span></span>
         A Pandoc AST element.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A type (e.g., &lsquo;MetaMap&rsquo;, &lsquo;Plain&rsquo;).</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A super-type (e.g., &lsquo;Block&rsquo; or &lsquo;MetaValue&rsquo;).</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        &lsquo;AstElement&rsquo;.</li>
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the given value is not a Pandoc AST element.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "elem_walk"></a>
    <strong>elem_walk (elem, filter)</strong>
    </dt>
    <dd>
    <p>Walk an AST and apply a filter to matching elements.</p>

<p> Differs from <code>pandoc.walk_block</code> and <code>pandoc.walk_inline</code> by:</p>

<ul>
<li>accepting AST elements of any type (inluding documents and metadata),</li>
<li>walking the AST bottom-up and
applying the filter to the given element itself,</li>
<li>allowing functions in the filter to return data of arbitrary types,</li>
<li>never modifying the original element, and</li>
<li>accepting &lsquo;AstElement&rsquo; as filter keyword,
but not &lsquo;Blocks&rsquo; or &lsquo;Inlines&rsquo;.</li>
</ul>


    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">elem</span>
            <span class="types"><span class="type">pandoc.AstElement</span></span>
         A Pandoc AST element.
        </li>
        <li><span class="parameter">filter</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string=func,...}</a></span>
         A filter.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Typically but not necessarily, a new Pandoc AST element.
    </ol>




</dd>
    <dt>
    <a name = "meta_sources"></a>
    <strong>meta_sources (meta)</strong>
    </dt>
    <dd>
    Collect bibliographic data.</p>

<p> Reads the <code>references</code> metadata field and every bibliography file.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">meta</span>
            <span class="types"><span class="type">pandoc.MetaMap</span></span>
         A metadata block.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.List</span></span>
        CSL items.
    </ol>




</dd>
    <dt>
    <a name = "doc_ckeys"></a>
    <strong>doc_ckeys (doc[, undef])</strong>
    </dt>
    <dd>
    Collect the citation keys used in a document.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Pandoc</span></span>
         A document.
        </li>
        <li><span class="parameter">undef</span>
            <span class="types"><span class="type">bool</span></span>
         Collect only undefind citation keys?
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
        Citation keys.</li>
        <li>
           <span class="types"><span class="type">int</span></span>
        The number of citation keys found.</li>
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Option_parsing"></a>Option parsing </h2>

    <dl class="function">
    <dt>
    <a name = "Option"></a>
    <strong>Option</strong>
    </dt>
    <dd>
    An option definition

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A optiona name.
        </li>
        <li><span class="parameter">type</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A type to coerce the option&rsquo;s value to.
         (<em>default</em> 'string')
        </li>
        <li><span class="parameter">check</span>
            <span class="types"><span class="type">func</span></span>
         A function that checks the option&rsquo;s value.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">prefix</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A prefix.
         (<em>optional</em>)
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="../index.html#Options:add">Options:add</a>
    </ul>


</dd>
    <dt>
    <a name = "Options"></a>
    <strong>Options</strong>
    </dt>
    <dd>
    An option parser.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Object">Object</a>
    </ul>




    <h3>See also:</h3>
    <ul>
         <li><a href="../index.html#Options:new">Options:new</a></li>
         <li><a href="../index.html#Options:add">Options:add</a></li>
         <li><a href="../index.html#Options:parse">Options:parse</a></li>
    </ul>


</dd>
    <dt>
    <a name = "Options:new"></a>
    <strong>Options:new ()</strong>
    </dt>
    <dd>
    <p>Create a new option parser.</p>

<pre><code>  parser = Options:new{name = 'foo'}
</code></pre>

<p> is equivalent to:</p>

<pre><code>  parser = Options()
  parser:add{name = 'foo'}
</code></pre>

    </ul>
    </ul>
    </ul>
    </ul>




    <h3>See also:</h3>
    <ul>
         <a href="../index.html#Options:add">Options:add</a>
    </ul>


</dd>
    <dt>
    <a name = "Options:add"></a>
    <strong>Options:add (...)</strong>
    </dt>
    <dd>
    Add an option definition to the parser.</p>

<p> <h3>Mapping of option names to metadata fieldnames:</h3></p>

<p> The name of the metadata field that is looked up by <a href="../index.html#Options:parse">Options:parse</a> is
 the name of the option with underscores replaced by dashes.</p>

<p> However, options may have prefixes. If so, the option name is prefixed
 with that prefix <em>and</em> &lsquo;-&rsquo; before being translated into a fieldname.</p>

<p> In Lua:</p>

<pre><code>if prefix then name = prefix .. '-' .. name end
fieldname = name:gsub('_', '-')
</code></pre>

<p> <h3>Type declaration grammar:</h3></p>

<p> Configuration values can be of one of three types:</p>

<ul>
<li>&lsquo;number&rsquo;</li>
<li>&lsquo;string&rsquo;</li>
<li>&lsquo;list&rsquo;</li>
</ul>


<p> If you declare an option to be of the scalar types &lsquo;number&rsquo; or
 &lsquo;string&rsquo;, its value is required to be of the Lua type of the
 same name. Values are converted automatically if possible.</p>

<p> If you declare an option to be of the type &lsquo;list&rsquo;, its value is
 required to be a <code>pandoc.List</code>. If a scalar is encountered where
 a list was expected, the value is wrapped in a single-item list.</p>

<p> The items of a list must all be of the same type, which you declare
 by appending &lsquo;&lt;<em>T</em>>&rsquo; to the literal &lsquo;list&rsquo;, where <em>T</em> is either the
 name of a scalar type or &lsquo;list&lt;&hellip;>&rsquo; and defaults to &lsquo;string&rsquo;.</p>

<p> Whitespace is ignored.</p>

<p> In <a href="https://en.wikipedia.org/wiki/EBNF">Extended Backus-Naur Form</a>:</p>

<blockquote><p>Whitespace = &lsquo; &rsquo; | TAB | CR | LF</p>

<p>Simple type = &lsquo;number&rsquo; | &lsquo;string&rsquo;</p>

<p>List = &lsquo;list&rsquo;, {whitespace},
       [&lsquo;&lt;&rsquo;, {whitespace}, (simple type | list), {whitespace}, &lsquo;>&rsquo;? ]</p>

<p>Type declaration = {whitespace}, (simple type | list), {whitespace}</p></blockquote>

<p> No checks are performed if a value is <code>nil</code>.</p>

<p> <h3>Check protocol:</h3></p>

<p> You can give a function that checks whether a setting&rsquo;s value is
 valid. That function is called after the value has been coerced
 to the requested type and should map valid values to <code>true</code> and
 invalid values to <code>nil</code> and an error message.</p>

<p> No checks are performed if a value is <code>nil</code>.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="../index.html#Option">Option</a></span>
         Options.
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="../index.html#Options:parse">Options:parse</a>
    </ul>

    <h3>Usage:</h3>
    <ul>
        <pre class="example">parser = Options()
parser:add{
    name = <span class="string">'bar'</span>,
    <span class="global">type</span> = <span class="string">'number'</span>,
    check = <span class="keyword">function</span> (x)
        <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="keyword">return</span> <span class="keyword">true</span> <span class="keyword">end</span>
        <span class="keyword">return</span> <span class="keyword">nil</span>, <span class="string">'not a positive number.'</span>
    <span class="keyword">end</span>
}</pre>
    </ul>

</dd>
    <dt>
    <a name = "Options:parse"></a>
    <strong>Options:parse (meta)</strong>
    </dt>
    <dd>
    Get configuration options from a metadata block.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">meta</span>
            <span class="types"><span class="type">pandoc.MetaMap</span></span>
         A metadata block.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        A mapping of setting names to values.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../index.html#Options:add">Options:add</a>
    </ul>

    <h3>Usage:</h3>
    <ul>
        <pre class="example">&gt; parser = Options()
&gt; parser:add{
&gt;     name = <span class="string">'bar'</span>,
&gt;     <span class="global">type</span> = <span class="string">'number'</span>,
&gt;     check = <span class="keyword">function</span> (x)
&gt;         <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="keyword">return</span> <span class="keyword">true</span> <span class="keyword">end</span>
&gt;         <span class="keyword">return</span> <span class="keyword">nil</span>, <span class="string">'not a positive number.'</span>
&gt;     <span class="keyword">end</span>
&gt; }
&gt; meta = pandoc.MetaMap{
&gt;     [<span class="string">'foo-bar'</span>] = pandoc.MetaInlines(pandoc.List{
&gt;         pandoc.Str <span class="string">"0123"</span>
&gt;     })
&gt; opts = parser:parse(meta)
&gt; opts.bars
<span class="number">123</span>
&gt; <span class="global">type</span>(opts.bar)
number</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Zotero_connectors"></a>Zotero connectors </h2>

    <dl class="function">
    <dt>
    <a name = "connectors"></a>
    <strong>connectors</strong>
    </dt>
    <dd>
    A case-insensitive namespace for connector prototypes.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "connectors.Zotero"></a>
    <strong>connectors.Zotero</strong>
    </dt>
    <dd>
    Interface to <a href="https://github.com/egh/zotxt">zotxt</a>.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Object">Object</a>
    </ul>





    <h3>Usage:</h3>
    <ul>
        <pre class="example">handle = connectors.Zotero:new()
item = handle:fetch <span class="string">'DoeWord2020'</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "connectors.Zotero.options"></a>
    <strong>connectors.Zotero.options</strong>
    </dt>
    <dd>
    Zotero options.</p>

<p> Defines <code>zotero-citekey-types</code>.
 See the manual for details.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#Options">Options</a>.
    </ul>






</dd>
    <dt>
    <a name = "connectors.Zotero.citekey_types"></a>
    <strong>connectors.Zotero.citekey_types</strong>
    </dt>
    <dd>
    Types of citation keys to expect.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "connectors.Zotero:fetch"></a>
    <strong>connectors.Zotero:fetch (ckey)</strong>
    </dt>
    <dd>
    Fetch a CSL item via zotxt.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A citation key (e.g., <code>'doe:2020word'</code>, <code>'DoeWord2020'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        A CSL item.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#http_get">http_get</a>.



</dd>
    <dt>
    <a name = "connectors.ZoteroWeb"></a>
    <strong>connectors.ZoteroWeb</strong>
    </dt>
    <dd>
    Interface to <a href="https://www.zotero.org/support/dev/web_api">Zotero&rsquo;s Web API</a>

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         <a href="../index.html#connectors.Zotero">connectors.Zotero</a>
    </ul>

    <h3>Uninitialised properties:</h3>
    <ul>
        <li><span class="parameter">api_key</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A Zotero Web API key.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">user_id</span>
            <span class="types"><span class="type">number</span></span>
         A Zotero user ID.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">groups</span>
            <span class="types"><span class="type">{number,...}</span></span>
         Zotero groups to search in.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">public_groups</span>
            <span class="types"><span class="type">{number,...}</span></span>
         Public Zotero groups to search in.
         (<em>optional</em>)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">handle = connectors.ZoteroWeb{api_key = <span class="string">'lettersandnumbers'</span>}
item = handle:fetch <span class="string">'DoeWord2020'</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.citekey_types"></a>
    <strong>connectors.ZoteroWeb.citekey_types</strong>
    </dt>
    <dd>
    Types of citation keys to expect.</p>

<p> See <a href="../index.html#citekey:guess_terms">citekey:guess_terms</a> for caveats.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.options"></a>
    <strong>connectors.ZoteroWeb.options</strong>
    </dt>
    <dd>
    Zotero Web API options.</p>

<p> Defines:</p>

<ul>
<li><code>zotero-api-key</code></li>
<li><code>zotero-user-id</code></li>
<li><code>zotero-groups</code></li>
<li><code>zotero-public-groups</code></li>
</ul>


<p> See the manual for details.

    </ul>
    </ul>
    </ul>
    <h3>Prototype:</h3>
    <ul>
         Copy of <a href="../index.html#connectors.Zotero.options">connectors.Zotero.options</a>.
    </ul>






</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.mt"></a>
    <strong>connectors.ZoteroWeb.mt</strong>
    </dt>
    <dd>
    Metatable for Zotero Web API connectors.

    </ul>
    </ul>
    </ul>
    </ul>






</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.mt.__call"></a>
    <strong>connectors.ZoteroWeb.mt.__call ()</strong>
    </dt>
    <dd>
    Delegate to the Zotero Web API interface.

    </ul>
    </ul>
    </ul>
    </ul>




    <h3>See also:</h3>
    <ul>
         <a href="../index.html#delegate_with_getters">delegate_with_getters</a>
    </ul>


</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.mt.getters"></a>
    <strong>connectors.ZoteroWeb.mt.getters</strong>
    </dt>
    <dd>
    Getters for Zotero Web API connectors.

    </ul>
    </ul>
    </ul>
    </ul>




    <h3>See also:</h3>
    <ul>
         <a href="../index.html#getterify">getterify</a>
    </ul>


</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.mt.getters.user_id"></a>
    <strong>connectors.ZoteroWeb.mt.getters.user_id (obj)</strong>
    </dt>
    <dd>
    Get the user ID for the given API key.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">obj</span>
            <span class="types"><a class="type" href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a></span>
         A Zotero Web API handle.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        A Zotero user ID.
    </ol>

    <h3>Raises:</h3>
    <p> An error if:</p>

<ul>
<li>the <code>api_key</code> field is not set,</li>
<li>the Zotero Web API could not be reached
(see <a href="../index.html#http_get">http_get</a> for details),</li>
<li>the API&rsquo;s response cannot be parsed,</li>
<li>no user ID could be found for the given Zotero API key.</li>
</ul>




</dd>
    <dt>
    <a name = "connectors.ZoteroWeb.mt.getters.groups"></a>
    <strong>connectors.ZoteroWeb.mt.getters.groups (obj)</strong>
    </dt>
    <dd>
    Get the IDs of the groups the current user is a member of.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">obj</span>
            <span class="types"><a class="type" href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a></span>
         A Zotero Web API handle.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">{string,...}</a></span>
        Zotero group IDs.
    </ol>

    <h3>Raises:</h3>
    <p> An error if:</p>

<ul>
<li>the <code>api_key</code> field is not set,</li>
<li>the Zotero Web API could not be reached
(see <a href="../index.html#http_get">http_get</a> for details),</li>
<li>the API&rsquo;s response cannot be parsed.</li>
</ul>




</dd>
    <dt>
    <a name = "connectors.ZoteroWeb:endpoints"></a>
    <strong>connectors.ZoteroWeb:endpoints ([id])</strong>
    </dt>
    <dd>
    Iterate over item endpoint URLs.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">id</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A Zotero item ID.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">func</span></span>
        A <em>stateful</em> iterator.
    </ol>




</dd>
    <dt>
    <a name = "connectors.ZoteroWeb:search"></a>
    <strong>connectors.ZoteroWeb:search (...)</strong>
    </dt>
    <dd>
    Search items by their author, publication year, and title.

    <h3>Caveats:</h3>
    <ul>
         Does <em>not</em> correct Zotero&rsquo;s CSL JSON export.
    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         Search terms.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        CSL items that match the given search terms.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no items were found or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">An</span></span>
        error message.</li>
    </ol>

    <h3>Raises:</h3>
     See <a href="../index.html#connectors.ZoteroWeb.mt.getters.user_id">connectors.ZoteroWeb.mt.getters.user_id</a> and
  <a href="../index.html#connectors.ZoteroWeb.mt.getters.groups">connectors.ZoteroWeb.mt.getters.groups</a>.



</dd>
    <dt>
    <a name = "connectors.ZoteroWeb:lookup"></a>
    <strong>connectors.ZoteroWeb:lookup (id)</strong>
    </dt>
    <dd>
    Look up a CSL item by its Zotero ID.

    </ul>
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">id</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A Zotero item ID.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        A CSL item.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no or more than one item has been found.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
     See <a href="../index.html#connectors.ZoteroWeb.mt.getters.user_id">connectors.ZoteroWeb.mt.getters.user_id</a> and
  <a href="../index.html#connectors.ZoteroWeb.mt.getters.groups">connectors.ZoteroWeb.mt.getters.groups</a>.



</dd>
    <dt>
    <a name = "connectors.ZoteroWeb:fetch"></a>
    <strong>connectors.ZoteroWeb:fetch (ckey)</strong>
    </dt>
    <dd>
    Fetch a CSL item from Zotero.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
          Search terms for citation keys are printed to STDERR
 if the user has requested verbose output.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ckey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A citation key (e.g., <code>'doe:2020word'</code>, <code>'DoeWord2020'</code>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        A CSL item.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
     See <a href="../index.html#connectors.ZoteroWeb.mt.getters.user_id">connectors.ZoteroWeb.mt.getters.user_id</a> and
  <a href="../index.html#connectors.ZoteroWeb.mt.getters.groups">connectors.ZoteroWeb.mt.getters.groups</a>.



</dd>
</dl>
    <h2 class="section-header "><a name="Main"></a>Main </h2>

    <dl class="function">
    <dt>
    <a name = "add_biblio"></a>
    <strong>add_biblio (fname, handle, doc)</strong>
    </dt>
    <dd>
    Add data to a bibliography file and the file to the document&rsquo;s metadata.</p>

<p> Updates the bibliography file as needed and adds its to the <code>bibliography</code>
 metadata field. Interpretes relative filenames as relative to the directory
 of the first input file passed to <strong>pandoc</strong>, or, if no input files were
 given, as relative to the current working directory.

    <h3>Caveats:</h3>
    <ul>
         <a href="../index.html#file_write">file_write</a>.
    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
         A filename for the bibliography file.
        </li>
        <li><span class="parameter">handle</span>
            <span class="types"><a class="type" href="../index.html#connectors.Zotero">connectors.Zotero</a> or <a class="type" href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a></span>
         A Zotero interface.
        </li>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Pandoc</span></span>
         A Pandoc document.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.Meta</span></span>
        An updated metadata block.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if nothing was done or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message, if applicable.</li>
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#connectors.Zotero">connectors.Zotero</a> and <a href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a>.



</dd>
    <dt>
    <a name = "add_refs"></a>
    <strong>add_refs (handle, doc)</strong>
    </dt>
    <dd>
    Add bibliographic data to the <code>references</code> metadata field.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">handle</span>
            <span class="types"><a class="type" href="../index.html#connectors.Zotero">connectors.Zotero</a> or <a class="type" href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a></span>
         A Zotero interface.
        </li>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Pandoc</span></span>
         A Pandoc document.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
        An updated metadata block.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if nothing was done or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        An error message, if applicable.</li>
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#connectors.Zotero">connectors.Zotero</a> and <a href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a>.



</dd>
    <dt>
    <a name = "main"></a>
    <strong>main (doc)</strong>
    </dt>
    <dd>
    Collect citations and add bibliographic data to the document.</p>

<p> See the manual for details.

    </ul>
    <h3>Side-effects:</h3>
    <ul>
         May print error messages to STDERR.
    </ul>
    </ul>
    </ul>

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Pandoc</span></span>
         A document.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.Pandoc</span></span>
        The document with bibliographic data added.
    </ol>
     <h3>Or</h3>
    <ol>

           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if nothing was done or an error occurred.
    </ol>

    <h3>Raises:</h3>
    See <a href="../index.html#connectors.Zotero">connectors.Zotero</a> and <a href="../index.html#connectors.ZoteroWeb">connectors.ZoteroWeb</a>.



</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2022-01-02 18:34:36 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
