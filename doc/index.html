<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>pandoc-zotxt.lua</h1>


<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Tables">Tables</a></li>
<li><a href="#Fields">Fields</a></li>
</ul>


<h2>Scripts</h2>
<ul class="nowrap">
  <li><strong>pandoc-zotxt.lua</strong></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="topics/README.md.html">README</a></li>
</ul>

</div>

<div id="content">

<h1>Script <code>pandoc-zotxt.lua</code></h1>
<p>pandoc-zotxt.lua - Looks up citations in Zotero and adds references.</p>
<p> SYNOPSIS</p>

<p>  pandoc --lua-filter pandoc-zotxt.lua --citeproc</p>

<p>  pandoc --lua-filter pandoc-zotxt.lua --filter pandoc-citeproc</p>

<p> DESCRIPTION</p>

<p> pandoc-zotxt.lua looks up sources of citations in Zotero and adds them
 either to a document's references metadata field or to its bibliography,
 where pandoc can pick them up.</p>

<p> You cite your sources using so-called "easy citekeys" (provided by
 zotxt) or "Better BibTeX Citation Keys" (provided by Better BibTeX for
 Zotero). Then, when running pandoc, you tell it to filter your document
 through pandoc-zotxt.lua by passing --lua-filter pandoc-zotxt.lua.
 That's all there is to it. You also have to tell pandoc to process
 citations, of course. (How you do this depends on your version of
 Pandoc.)</p>

<p> BIBLIOGRAPHY FILES</p>

<p> You can also use pandoc-zotxt.lua to manage a bibliography file. This
 speeds up subsequent runs of pandoc-zotxt.lua for the same document,
 because pandoc-zotxt.lua will only fetch sources from Zotero that aren't
 yet in that file. Simply set the zotero-bibliography metadata field to a
 filename. pandoc-zotxt.lua will then add sources to that file, rather
 than to the references metadata field. It will also add that file to the
 document's bibliography metadata field, so that pandoc picks up those
 sources. The biblography is stored as a JSON file, so the filename must
 end with ".json". You can safely set zotero-bibliography and
 bibliography at the same time.</p>

<p> pandoc-zotxt.lua interprets relative filenames as relative to the
 directory of the first input file that you pass to pandoc or, if you
 don't pass any input file, as relative to the current working directory.</p>

<p> Note, pandoc-zotxt.lua only ever adds sources to bibliography files. It
 doesn't update or delete them. If you want to update the sources in your
 bibliography file, delete it. pandoc-zotxt.lua will then regenerate it
 from scratch.</p>

<p> KNOWN ISSUES</p>

<p> Zotero, from v5.0.71 onwards, doesn't allow browsers to access its
 interface. It defines "browser" as any user agent that sets the "User
 Agent" HTTP header to a string that starts with "Mozilla/".</p>

<p> However, Zotero v5.0.71 and v5.0.72 fail to handle HTTP requests from
 user agents that don't set the "User Agent" HTTP header. And pandoc
 doesn't. As a consequence, pandoc-zotxt.lua cannot retrieve data from
 these versions of Zotero, that is, unless you tell pandoc to set that
 header.</p>

<p> If you cannot upgrade to a more recent version of Zotero, you can make
 pandoc set that header by passing, for instance, --request-header
 User-Agent:Pandoc/2. If you must set the "User Agent" HTTP header to a
 string that starts with "Mozilla/", you can still get pandoc to connect
 to Zotero by setting the HTTP header "Zotero-Allowed-Request". You do so
 by passing --request-header Zotero-Allowed-Request:X.</p>

<p> CAVEATS</p>

<p> pandoc-zotxt.lua is for the most part Unicode-agnostic.</p>

<p> SEE ALSO</p>

<ul>
    <li>zotxt</li>
    <li>Better BibTeX</li>
</ul>

<p> pandoc(1), pandoc-citeproc(1)</p>
    <h3>Info:</h3>
    <ul>
        <li><strong>Copyright</strong>: 2018, 2019, 2020 Odin Kroeger</li>
        <li><strong>Release</strong>: 0.3.19</li>
        <li><strong>License</strong>: MIT</li>
        <li><strong>Author</strong>: Odin Kroeger</li>
    </ul>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#split_path">split_path (path)</a></td>
	<td class="summary">Splits a file's path into a directory and a filename part.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#warn">warn (msg, ...)</a></td>
	<td class="summary">Prints warnings to STDERR.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_position">get_position (elem, list)</a></td>
	<td class="summary">Returns the position of an element in a list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#map">map (func, list)</a></td>
	<td class="summary">Applies a function to every element of a list.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#is_path_absolute">is_path_absolute (path)</a></td>
	<td class="summary">Checks if a path is absolute.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_input_directory">get_input_directory ()</a></td>
	<td class="summary">Returns the directory of the first input file or '.'.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#read_json_file">read_json_file (fname)</a></td>
	<td class="summary">Reads a JSON file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#write_json_file">write_json_file (data, fname)</a></td>
	<td class="summary">Writes data to a file in JSON.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#read_url">read_url (url)</a></td>
	<td class="summary">Retrieves data via an HTTP GET request from a URL.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#convert_numbers_to_strings">convert_numbers_to_strings (data)</a></td>
	<td class="summary">Converts all numbers in a multi-dimensional table to strings.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_source_json">get_source_json (citekey)</a></td>
	<td class="summary">Retrieves bibliographic data in CSL JSON for a source.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_source_csl">get_source_csl (citekey)</a></td>
	<td class="summary">Retrieves bibliographic data in CSL for a source.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_source">get_source (citekey)</a></td>
	<td class="summary">Retrieves bibliographic data for a source.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_citekeys">get_citekeys (doc)</a></td>
	<td class="summary">Collects the citation keys occurring in a document.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#update_bibliography">update_bibliography (citekeys, fname)</a></td>
	<td class="summary">Adds cited sources to a bibliography file.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#add_bibliography">add_bibliography (citekeys, meta)</a></td>
	<td class="summary">Adds sources to a bibliography.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#add_references">add_references (citekeys, meta)</a></td>
	<td class="summary">Adds sources to metadata block of a document.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#main">main (doc)</a></td>
	<td class="summary">Collects sources and adds bibliographic data to document.</td>
	</tr>
</table>
<h2><a href="#Tables">Tables</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ZOTXT_KEYTYPES">ZOTXT_KEYTYPES</a></td>
	<td class="summary">Types of citation keys.</td>
	</tr>
</table>
<h2><a href="#Fields">Fields</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#ZOTXT_BASE_URL">ZOTXT_BASE_URL</a></td>
	<td class="summary">The URL to lookup citation data.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#NAME">NAME</a></td>
	<td class="summary">The name of this script.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#VERSION">VERSION</a></td>
	<td class="summary">The version of this script.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#PATH_SEP">PATH_SEP</a></td>
	<td class="summary">The path seperator of the operating system.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#EOL">EOL</a></td>
	<td class="summary">The end of line sequence of the operating system.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "split_path"></a>
    <strong>split_path (path)</strong>
    </dt>
    <dd>
    Splits a file's path into a directory and a filename part.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The path to the file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        The file's path.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The file's name.</p>

<p> This function makes an educated guess given the string it's passed.
 It doesn't look at the filesystem. The guess is educated enough though.</li>
    </ol>




</dd>
    <dt>
    <a name = "warn"></a>
    <strong>warn (msg, ...)</strong>
    </dt>
    <dd>
    Prints warnings to STDERR. </p>

<p> Prefixes messages with <a href="index.html#NAME">NAME</a> and ": ".
 Also appends <a href="index.html#EOL">EOL</a>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">msg</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         A message to write to STDERR.
        </li>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         Arguments (think <a href="https://www.lua.org/manual/5.3/manual.html#pdf-string.format">string.format</a>) for <code>msg</code>.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "get_position"></a>
    <strong>get_position (elem, list)</strong>
    </dt>
    <dd>
    Returns the position of an element in a list.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">elem</span>
         The element.
        </li>
        <li><span class="parameter">list</span>
            <span class="types"><span class="type">tab</span></span>
         The list.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">integer</span></span>
        The index of the element,
    </ol>
     <h3>Or</h3>
    <ol>

           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the list doesn't contain the element.
    </ol>




</dd>
    <dt>
    <a name = "map"></a>
    <strong>map (func, list)</strong>
    </dt>
    <dd>
    Applies a function to every element of a list.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">func</span>
            <span class="types"><span class="type">func</span></span>
         The function.
        </li>
        <li><span class="parameter">list</span>
            <span class="types"><span class="type">tab</span></span>
         The list.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">tab</span></span>
        The return values of <code>func</code>.
    </ol>




</dd>
    <dt>
    <a name = "is_path_absolute"></a>
    <strong>is_path_absolute (path)</strong>
    </dt>
    <dd>
    Checks if a path is absolute.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         A path.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the path is absolute, <code>false</code> otherwise.
    </ol>




</dd>
    <dt>
    <a name = "get_input_directory"></a>
    <strong>get_input_directory ()</strong>
    </dt>
    <dd>
    Returns the directory of the first input file or '.'.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        The directory the first input file is in.
    </ol>




</dd>
    <dt>
    <a name = "read_json_file"></a>
    <strong>read_json_file (fname)</strong>
    </dt>
    <dd>
    Reads a JSON file.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         Name of the file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The parsed data.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">number</span></span>
        An error number. Positive numbers are OS error numbers,
  negative numbers indicate a JSON decoding error.</li>
    </ol>




</dd>
    <dt>
    <a name = "write_json_file"></a>
    <strong>write_json_file (data, fname)</strong>
    </dt>
    <dd>
    Writes data to a file in JSON. </p>

<p> Terminates files with <a href="index.html#EOL">EOL</a>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">data</span>
         Data.
        </li>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         Name of the file.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if <code>data</code> was written to the file.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
        <li>
           <span class="types"><span class="type">number</span></span>
        An error number. Positive numbers are OS error numbers,
  negative numbers indicate a JSON decoding error.</li>
    </ol>




</dd>
    <dt>
    <a name = "read_url"></a>
    <strong>read_url (url)</strong>
    </dt>
    <dd>
    Retrieves data via an HTTP GET request from a URL. </p>

<p> This is a function of its own only in order for the test scripts to
 be able to easily replace it with a function that redirects HTTP GET
 requests to pre-generated canned responses.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">url</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The URL.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        The data.
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if it cannot retrieve any data.



</dd>
    <dt>
    <a name = "convert_numbers_to_strings"></a>
    <strong>convert_numbers_to_strings (data)</strong>
    </dt>
    <dd>
    Converts all numbers in a multi-dimensional table to strings. </p>

<p> Also converts floating point numbers to integers. This is needed
 because all numbers are floating point numbers in JSON, but older
 versions of Pandoc expect integers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">data</span>
         Data of any type.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The given data, with all numbers converted into strings.
    </ol>




</dd>
    <dt>
    <a name = "get_source_json"></a>
    <strong>get_source_json (citekey)</strong>
    </dt>
    <dd>
    Retrieves bibliographic data in CSL JSON for a source. </p>

<p> Tries different types of citation keys, starting with the last
 one that a lookup was successful for.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The citation key of the source,
  e.g., 'name:2019word', 'name2019TwoWords'.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        A CSL JSON string.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the source wasn't found or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if it cannot retrieve any data and
  a catchable error if <code>citekey</code> is not a <a href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a>.



</dd>
    <dt>
    <a name = "get_source_csl"></a>
    <strong>get_source_csl (citekey)</strong>
    </dt>
    <dd>
    Retrieves bibliographic data in CSL for a source.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The citation key of the source,
  e.g., 'name:2019word', 'name2019TwoWords'.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.6">table</a></span>
        A CSL item.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the source wasn't found or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if it cannot retrieve any data and
  a catchable error if <code>citekey</code> is not a <a href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a>.



</dd>
    <dt>
    <a name = "get_source"></a>
    <strong>get_source (citekey)</strong>
    </dt>
    <dd>
    Retrieves bibliographic data for a source. </p>

<p> Bibliography entries are different to references,
 because Pandoc, starting with version 2.11,
 parses them differently.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekey</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The citation key of the source,
  e.g., 'name:2019word', 'name2019TwoWords'.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.6">table</a></span>
        Bibliographic data for that item.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if the source wasn't found or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if it cannot retrieve any data or cannot
  parse the reply, and a catchable error if <code>citekey</code> is not a <a href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a>.



</dd>
    <dt>
    <a name = "get_citekeys"></a>
    <strong>get_citekeys (doc)</strong>
    </dt>
    <dd>
    Collects the citation keys occurring in a document.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Doc</span></span>
         A document.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">{string,...}</a></span>
        A list of citation keys.
    </ol>




</dd>
    <dt>
    <a name = "update_bibliography"></a>
    <strong>update_bibliography (citekeys, fname)</strong>
    </dt>
    <dd>
    Adds cited sources to a bibliography file. </p>

<p> Prints an error message to STDERR for every source that cannot be found.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekeys</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">{string,...}</a></span>
         The citation keys of the sources to add,
  e.g., 'name:2019word', 'name2019WordWordWord'.
        </li>
        <li><span class="parameter">fname</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
         The filename of the bibliography.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">bool</span></span>
        <code>true</code> if the bibliography file was updated
  or no update was needed.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if an error occurrs.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message.</li>
    </ol>

    <h3>Raises:</h3>
     An uncatchable error if it cannot retrieve any data and
  a catchable error if <code>fname</code> is not a string, <code>citekeys</code> is not a table,
  <code>fname</code> is the empty string.



</dd>
    <dt>
    <a name = "add_bibliography"></a>
    <strong>add_bibliography (citekeys, meta)</strong>
    </dt>
    <dd>
    Adds sources to a bibliography. </p>

<p> Also adds that bibliography to the document's metadata.
 Prints an error message to STDERR for every source that cannot be found.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekeys</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">{string,...}</a></span>
         The citation keys of the sources to add.
        </li>
        <li><span class="parameter">meta</span>
            <span class="types"><span class="type">pandoc.Meta</span></span>
         A metadata block.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.Meta</span></span>
        An updated metadata block, with the field
  <code>bibliography</code> added if needed.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no sources were found,
  <code>zotero-bibliography</code> is not set, or an error occurred.</li>
        <li>
           <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">string</a></span>
        An error message, if applicable.</li>
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if <code>zotero-bibliography</code> isn't a string.



</dd>
    <dt>
    <a name = "add_references"></a>
    <strong>add_references (citekeys, meta)</strong>
    </dt>
    <dd>
    Adds sources to metadata block of a document. </p>

<p> Prints an error message to STDERR for every source that cannot be found.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">citekeys</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.3/manual.html#6.4">{string,...}</a></span>
         The citation keys of the sources to add.
        </li>
        <li><span class="parameter">meta</span>
            <span class="types"><span class="type">pandoc.Meta</span></span>
         A metadata block.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.Meta</span></span>
        An updated metadata block, with the field
  <code>references</code> added if needed.
    </ol>
     <h3>Or</h3>
    <ol>

           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if no sources were found.
    </ol>

    <h3>Raises:</h3>
    An uncatchable error if it cannot retrieve any data.



</dd>
    <dt>
    <a name = "main"></a>
    <strong>main (doc)</strong>
    </dt>
    <dd>
    Collects sources and adds bibliographic data to document. </p>

<p> Prints messages to STDERR if errors occur.</p>

<p> See the manual page for detais.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">doc</span>
            <span class="types"><span class="type">pandoc.Pandoc</span></span>
         A document.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">pandoc.Pandoc</span></span>
        <code>doc</code>, but with bibliographic data added.
    </ol>
     <h3>Or</h3>
    <ol>

           <span class="types"><span class="type">nil</span></span>
        <code>nil</code> if nothing was done or an error occurred.
    </ol>

    <h3>Raises:</h3>
     An uncatchable error if it cannot retrieve any data or,
  depending on your version of Pandoc, when it cannot parse
  zotxt's reponse as JSON.



</dd>
</dl>
    <h2 class="section-header "><a name="Tables"></a>Tables</h2>

    <dl class="function">
    <dt>
    <a name = "ZOTXT_KEYTYPES"></a>
    <strong>ZOTXT_KEYTYPES</strong>
    </dt>
    <dd>
    Types of citation keys. </p>

<p> See <a href="https://github.com/egh/zotxt">https://github.com/egh/zotxt</a> for details.


    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">easykey</span>
        zotxt easy citekey
        </li>
        <li><span class="parameter">betterbibtexkey</span>
        Better BibTeX citation key
        </li>
        <li><span class="parameter">key</span>
        Zotero item ID
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="index.html#get_source_json">get_source_json</a>
    </ul>


</dd>
</dl>
    <h2 class="section-header "><a name="Fields"></a>Fields</h2>

    <dl class="function">
    <dt>
    <a name = "ZOTXT_BASE_URL"></a>
    <strong>ZOTXT_BASE_URL</strong>
    </dt>
    <dd>

<p>The URL to lookup citation data. </p>

<p> See <a href="https://github.com/egh/zotxt">https://github.com/egh/zotxt</a> for details.</p>

<p> <a href="index.html#get_source_json">get_source_json</a> replaces:</p>

<ul>
    <li>the first '%s' with the citation key type (e.g., 'easykey'),</li>
    <li>the second '%s' with the citation key (e.g., 'doe:2000word').</li>
</ul>







    <h3>See also:</h3>
    <ul>
         <a href="index.html#get_source_json">get_source_json</a>
    </ul>


</dd>
    <dt>
    <a name = "NAME"></a>
    <strong>NAME</strong>
    </dt>
    <dd>
    The name of this script.







</dd>
    <dt>
    <a name = "VERSION"></a>
    <strong>VERSION</strong>
    </dt>
    <dd>
    The version of this script.







</dd>
    <dt>
    <a name = "PATH_SEP"></a>
    <strong>PATH_SEP</strong>
    </dt>
    <dd>
    The path seperator of the operating system.







</dd>
    <dt>
    <a name = "EOL"></a>
    <strong>EOL</strong>
    </dt>
    <dd>
    The end of line sequence of the operating system.







</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2020-10-23 12:06:55 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
